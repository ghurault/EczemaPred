[{"path":[]},{"path":"/CONTRIBUTING.html","id":"updating-stan-files","dir":"","previous_headings":"","what":"Updating Stan files","title":"Note to contributors","text":"updating Stan files, run following:","code":"rstantools::rstan_config() example(source) # defines the sourceDir() function try(roxygen2::roxygenize(load_code = sourceDir), silent = TRUE) pkgbuild::compile_dll() roxygen2::roxygenize()"},{"path":"/CONTRIBUTING.html","id":"website","dir":"","previous_headings":"","what":"Website","title":"Note to contributors","text":"website deployed “gh-pages” branch repository, using GitHub Actions. regenerate website locally, use pkgdown::build_site().","code":""},{"path":"/CONTRIBUTING.html","id":"stan-specific-notes","dir":"","previous_headings":"","what":"Stan-specific notes","title":"Note to contributors","text":".stan files containing stanmodel definitions must placed inst/stan. Additional files included stanmodel definition files (via e.g., #include \"mylib.stan\") must placed subfolder inst/stan. Additional C++ files needed .stan file must placed inst/include, can interact Stan C++ library via #include directives placed file inst/include/stan_meta_header.hpp. precompiled stanmodel objects appear named list called stanmodels, can call e.g., rstan::sampling(stanmodels$foo, ...) See Guidelines developers R packages interfacing Stan information.","code":""},{"path":"/CONTRIBUTING.html","id":"git","dir":"","previous_headings":"","what":"Git","title":"Note to contributors","text":"try follow Git flow managing repository.","code":""},{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"GNU General Public License","title":"GNU General Public License","text":"Version 3, 29 June 2007Copyright © 2007 Free Software Foundation, Inc. <http://fsf.org/> Everyone permitted copy distribute verbatim copies license document, changing allowed.","code":""},{"path":"/LICENSE.html","id":"preamble","dir":"","previous_headings":"","what":"Preamble","title":"GNU General Public License","text":"GNU General Public License free, copyleft license software kinds works. licenses software practical works designed take away freedom share change works. contrast, GNU General Public License intended guarantee freedom share change versions program–make sure remains free software users. , Free Software Foundation, use GNU General Public License software; applies also work released way authors. can apply programs, . speak free software, referring freedom, price. General Public Licenses designed make sure freedom distribute copies free software (charge wish), receive source code can get want , can change software use pieces new free programs, know can things. protect rights, need prevent others denying rights asking surrender rights. Therefore, certain responsibilities distribute copies software, modify : responsibilities respect freedom others. example, distribute copies program, whether gratis fee, must pass recipients freedoms received. must make sure , , receive can get source code. must show terms know rights. Developers use GNU GPL protect rights two steps: (1) assert copyright software, (2) offer License giving legal permission copy, distribute /modify . developers’ authors’ protection, GPL clearly explains warranty free software. users’ authors’ sake, GPL requires modified versions marked changed, problems attributed erroneously authors previous versions. devices designed deny users access install run modified versions software inside , although manufacturer can . fundamentally incompatible aim protecting users’ freedom change software. systematic pattern abuse occurs area products individuals use, precisely unacceptable. Therefore, designed version GPL prohibit practice products. problems arise substantially domains, stand ready extend provision domains future versions GPL, needed protect freedom users. Finally, every program threatened constantly software patents. States allow patents restrict development use software general-purpose computers, , wish avoid special danger patents applied free program make effectively proprietary. prevent , GPL assures patents used render program non-free. precise terms conditions copying, distribution modification follow.","code":""},{"path":[]},{"path":"/LICENSE.html","id":"0-definitions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"0. Definitions","title":"GNU General Public License","text":"“License” refers version 3 GNU General Public License. “Copyright” also means copyright-like laws apply kinds works, semiconductor masks. “Program” refers copyrightable work licensed License. licensee addressed “”. “Licensees” “recipients” may individuals organizations. “modify” work means copy adapt part work fashion requiring copyright permission, making exact copy. resulting work called “modified version” earlier work work “based ” earlier work. “covered work” means either unmodified Program work based Program. “propagate” work means anything , without permission, make directly secondarily liable infringement applicable copyright law, except executing computer modifying private copy. Propagation includes copying, distribution (without modification), making available public, countries activities well. “convey” work means kind propagation enables parties make receive copies. Mere interaction user computer network, transfer copy, conveying. interactive user interface displays “Appropriate Legal Notices” extent includes convenient prominently visible feature (1) displays appropriate copyright notice, (2) tells user warranty work (except extent warranties provided), licensees may convey work License, view copy License. interface presents list user commands options, menu, prominent item list meets criterion.","code":""},{"path":"/LICENSE.html","id":"1-source-code","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"1. Source Code","title":"GNU General Public License","text":"“source code” work means preferred form work making modifications . “Object code” means non-source form work. “Standard Interface” means interface either official standard defined recognized standards body, , case interfaces specified particular programming language, one widely used among developers working language. “System Libraries” executable work include anything, work whole, () included normal form packaging Major Component, part Major Component, (b) serves enable use work Major Component, implement Standard Interface implementation available public source code form. “Major Component”, context, means major essential component (kernel, window system, ) specific operating system () executable work runs, compiler used produce work, object code interpreter used run . “Corresponding Source” work object code form means source code needed generate, install, (executable work) run object code modify work, including scripts control activities. However, include work’s System Libraries, general-purpose tools generally available free programs used unmodified performing activities part work. example, Corresponding Source includes interface definition files associated source files work, source code shared libraries dynamically linked subprograms work specifically designed require, intimate data communication control flow subprograms parts work. Corresponding Source need include anything users can regenerate automatically parts Corresponding Source. Corresponding Source work source code form work.","code":""},{"path":"/LICENSE.html","id":"2-basic-permissions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"2. Basic Permissions","title":"GNU General Public License","text":"rights granted License granted term copyright Program, irrevocable provided stated conditions met. License explicitly affirms unlimited permission run unmodified Program. output running covered work covered License output, given content, constitutes covered work. License acknowledges rights fair use equivalent, provided copyright law. may make, run propagate covered works convey, without conditions long license otherwise remains force. may convey covered works others sole purpose make modifications exclusively , provide facilities running works, provided comply terms License conveying material control copyright. thus making running covered works must exclusively behalf, direction control, terms prohibit making copies copyrighted material outside relationship . Conveying circumstances permitted solely conditions stated . Sublicensing allowed; section 10 makes unnecessary.","code":""},{"path":"/LICENSE.html","id":"3-protecting-users-legal-rights-from-anti-circumvention-law","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"3. Protecting Users’ Legal Rights From Anti-Circumvention Law","title":"GNU General Public License","text":"covered work shall deemed part effective technological measure applicable law fulfilling obligations article 11 WIPO copyright treaty adopted 20 December 1996, similar laws prohibiting restricting circumvention measures. convey covered work, waive legal power forbid circumvention technological measures extent circumvention effected exercising rights License respect covered work, disclaim intention limit operation modification work means enforcing, work’s users, third parties’ legal rights forbid circumvention technological measures.","code":""},{"path":"/LICENSE.html","id":"4-conveying-verbatim-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"4. Conveying Verbatim Copies","title":"GNU General Public License","text":"may convey verbatim copies Program’s source code receive , medium, provided conspicuously appropriately publish copy appropriate copyright notice; keep intact notices stating License non-permissive terms added accord section 7 apply code; keep intact notices absence warranty; give recipients copy License along Program. may charge price price copy convey, may offer support warranty protection fee.","code":""},{"path":"/LICENSE.html","id":"5-conveying-modified-source-versions","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"5. Conveying Modified Source Versions","title":"GNU General Public License","text":"may convey work based Program, modifications produce Program, form source code terms section 4, provided also meet conditions: ) work must carry prominent notices stating modified , giving relevant date. b) work must carry prominent notices stating released License conditions added section 7. requirement modifies requirement section 4 “keep intact notices”. c) must license entire work, whole, License anyone comes possession copy. License therefore apply, along applicable section 7 additional terms, whole work, parts, regardless packaged. License gives permission license work way, invalidate permission separately received . d) work interactive user interfaces, must display Appropriate Legal Notices; however, Program interactive interfaces display Appropriate Legal Notices, work need make . compilation covered work separate independent works, nature extensions covered work, combined form larger program, volume storage distribution medium, called “aggregate” compilation resulting copyright used limit access legal rights compilation’s users beyond individual works permit. Inclusion covered work aggregate cause License apply parts aggregate.","code":""},{"path":"/LICENSE.html","id":"6-conveying-non-source-forms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"6. Conveying Non-Source Forms","title":"GNU General Public License","text":"may convey covered work object code form terms sections 4 5, provided also convey machine-readable Corresponding Source terms License, one ways: ) Convey object code , embodied , physical product (including physical distribution medium), accompanied Corresponding Source fixed durable physical medium customarily used software interchange. b) Convey object code , embodied , physical product (including physical distribution medium), accompanied written offer, valid least three years valid long offer spare parts customer support product model, give anyone possesses object code either (1) copy Corresponding Source software product covered License, durable physical medium customarily used software interchange, price reasonable cost physically performing conveying source, (2) access copy Corresponding Source network server charge. c) Convey individual copies object code copy written offer provide Corresponding Source. alternative allowed occasionally noncommercially, received object code offer, accord subsection 6b. d) Convey object code offering access designated place (gratis charge), offer equivalent access Corresponding Source way place charge. need require recipients copy Corresponding Source along object code. place copy object code network server, Corresponding Source may different server (operated third party) supports equivalent copying facilities, provided maintain clear directions next object code saying find Corresponding Source. Regardless server hosts Corresponding Source, remain obligated ensure available long needed satisfy requirements. e) Convey object code using peer--peer transmission, provided inform peers object code Corresponding Source work offered general public charge subsection 6d. separable portion object code, whose source code excluded Corresponding Source System Library, need included conveying object code work. “User Product” either (1) “consumer product”, means tangible personal property normally used personal, family, household purposes, (2) anything designed sold incorporation dwelling. determining whether product consumer product, doubtful cases shall resolved favor coverage. particular product received particular user, “normally used” refers typical common use class product, regardless status particular user way particular user actually uses, expects expected use, product. product consumer product regardless whether product substantial commercial, industrial non-consumer uses, unless uses represent significant mode use product. “Installation Information” User Product means methods, procedures, authorization keys, information required install execute modified versions covered work User Product modified version Corresponding Source. information must suffice ensure continued functioning modified object code case prevented interfered solely modification made. convey object code work section , , specifically use , User Product, conveying occurs part transaction right possession use User Product transferred recipient perpetuity fixed term (regardless transaction characterized), Corresponding Source conveyed section must accompanied Installation Information. requirement apply neither third party retains ability install modified object code User Product (example, work installed ROM). requirement provide Installation Information include requirement continue provide support service, warranty, updates work modified installed recipient, User Product modified installed. Access network may denied modification materially adversely affects operation network violates rules protocols communication across network. Corresponding Source conveyed, Installation Information provided, accord section must format publicly documented (implementation available public source code form), must require special password key unpacking, reading copying.","code":""},{"path":"/LICENSE.html","id":"7-additional-terms","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"7. Additional Terms","title":"GNU General Public License","text":"“Additional permissions” terms supplement terms License making exceptions one conditions. Additional permissions applicable entire Program shall treated though included License, extent valid applicable law. additional permissions apply part Program, part may used separately permissions, entire Program remains governed License without regard additional permissions. convey copy covered work, may option remove additional permissions copy, part . (Additional permissions may written require removal certain cases modify work.) may place additional permissions material, added covered work, can give appropriate copyright permission. Notwithstanding provision License, material add covered work, may (authorized copyright holders material) supplement terms License terms: ) Disclaiming warranty limiting liability differently terms sections 15 16 License; b) Requiring preservation specified reasonable legal notices author attributions material Appropriate Legal Notices displayed works containing ; c) Prohibiting misrepresentation origin material, requiring modified versions material marked reasonable ways different original version; d) Limiting use publicity purposes names licensors authors material; e) Declining grant rights trademark law use trade names, trademarks, service marks; f) Requiring indemnification licensors authors material anyone conveys material (modified versions ) contractual assumptions liability recipient, liability contractual assumptions directly impose licensors authors. non-permissive additional terms considered “restrictions” within meaning section 10. Program received , part , contains notice stating governed License along term restriction, may remove term. license document contains restriction permits relicensing conveying License, may add covered work material governed terms license document, provided restriction survive relicensing conveying. add terms covered work accord section, must place, relevant source files, statement additional terms apply files, notice indicating find applicable terms. Additional terms, permissive non-permissive, may stated form separately written license, stated exceptions; requirements apply either way.","code":""},{"path":"/LICENSE.html","id":"8-termination","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"8. Termination","title":"GNU General Public License","text":"may propagate modify covered work except expressly provided License. attempt otherwise propagate modify void, automatically terminate rights License (including patent licenses granted third paragraph section 11). However, cease violation License, license particular copyright holder reinstated () provisionally, unless copyright holder explicitly finally terminates license, (b) permanently, copyright holder fails notify violation reasonable means prior 60 days cessation. Moreover, license particular copyright holder reinstated permanently copyright holder notifies violation reasonable means, first time received notice violation License (work) copyright holder, cure violation prior 30 days receipt notice. Termination rights section terminate licenses parties received copies rights License. rights terminated permanently reinstated, qualify receive new licenses material section 10.","code":""},{"path":"/LICENSE.html","id":"9-acceptance-not-required-for-having-copies","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"9. Acceptance Not Required for Having Copies","title":"GNU General Public License","text":"required accept License order receive run copy Program. Ancillary propagation covered work occurring solely consequence using peer--peer transmission receive copy likewise require acceptance. However, nothing License grants permission propagate modify covered work. actions infringe copyright accept License. Therefore, modifying propagating covered work, indicate acceptance License .","code":""},{"path":"/LICENSE.html","id":"10-automatic-licensing-of-downstream-recipients","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"10. Automatic Licensing of Downstream Recipients","title":"GNU General Public License","text":"time convey covered work, recipient automatically receives license original licensors, run, modify propagate work, subject License. responsible enforcing compliance third parties License. “entity transaction” transaction transferring control organization, substantially assets one, subdividing organization, merging organizations. propagation covered work results entity transaction, party transaction receives copy work also receives whatever licenses work party’s predecessor interest give previous paragraph, plus right possession Corresponding Source work predecessor interest, predecessor can get reasonable efforts. may impose restrictions exercise rights granted affirmed License. example, may impose license fee, royalty, charge exercise rights granted License, may initiate litigation (including cross-claim counterclaim lawsuit) alleging patent claim infringed making, using, selling, offering sale, importing Program portion .","code":""},{"path":"/LICENSE.html","id":"11-patents","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"11. Patents","title":"GNU General Public License","text":"“contributor” copyright holder authorizes use License Program work Program based. work thus licensed called contributor’s “contributor version”. contributor’s “essential patent claims” patent claims owned controlled contributor, whether already acquired hereafter acquired, infringed manner, permitted License, making, using, selling contributor version, include claims infringed consequence modification contributor version. purposes definition, “control” includes right grant patent sublicenses manner consistent requirements License. contributor grants non-exclusive, worldwide, royalty-free patent license contributor’s essential patent claims, make, use, sell, offer sale, import otherwise run, modify propagate contents contributor version. following three paragraphs, “patent license” express agreement commitment, however denominated, enforce patent (express permission practice patent covenant sue patent infringement). “grant” patent license party means make agreement commitment enforce patent party. convey covered work, knowingly relying patent license, Corresponding Source work available anyone copy, free charge terms License, publicly available network server readily accessible means, must either (1) cause Corresponding Source available, (2) arrange deprive benefit patent license particular work, (3) arrange, manner consistent requirements License, extend patent license downstream recipients. “Knowingly relying” means actual knowledge , patent license, conveying covered work country, recipient’s use covered work country, infringe one identifiable patents country reason believe valid. , pursuant connection single transaction arrangement, convey, propagate procuring conveyance , covered work, grant patent license parties receiving covered work authorizing use, propagate, modify convey specific copy covered work, patent license grant automatically extended recipients covered work works based . patent license “discriminatory” include within scope coverage, prohibits exercise , conditioned non-exercise one rights specifically granted License. may convey covered work party arrangement third party business distributing software, make payment third party based extent activity conveying work, third party grants, parties receive covered work , discriminatory patent license () connection copies covered work conveyed (copies made copies), (b) primarily connection specific products compilations contain covered work, unless entered arrangement, patent license granted, prior 28 March 2007. Nothing License shall construed excluding limiting implied license defenses infringement may otherwise available applicable patent law.","code":""},{"path":"/LICENSE.html","id":"12-no-surrender-of-others-freedom","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"12. No Surrender of Others’ Freedom","title":"GNU General Public License","text":"conditions imposed (whether court order, agreement otherwise) contradict conditions License, excuse conditions License. convey covered work satisfy simultaneously obligations License pertinent obligations, consequence may convey . example, agree terms obligate collect royalty conveying convey Program, way satisfy terms License refrain entirely conveying Program.","code":""},{"path":"/LICENSE.html","id":"13-use-with-the-gnu-affero-general-public-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"13. Use with the GNU Affero General Public License","title":"GNU General Public License","text":"Notwithstanding provision License, permission link combine covered work work licensed version 3 GNU Affero General Public License single combined work, convey resulting work. terms License continue apply part covered work, special requirements GNU Affero General Public License, section 13, concerning interaction network apply combination .","code":""},{"path":"/LICENSE.html","id":"14-revised-versions-of-this-license","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"14. Revised Versions of this License","title":"GNU General Public License","text":"Free Software Foundation may publish revised /new versions GNU General Public License time time. new versions similar spirit present version, may differ detail address new problems concerns. version given distinguishing version number. Program specifies certain numbered version GNU General Public License “later version” applies , option following terms conditions either numbered version later version published Free Software Foundation. Program specify version number GNU General Public License, may choose version ever published Free Software Foundation. Program specifies proxy can decide future versions GNU General Public License can used, proxy’s public statement acceptance version permanently authorizes choose version Program. Later license versions may give additional different permissions. However, additional obligations imposed author copyright holder result choosing follow later version.","code":""},{"path":"/LICENSE.html","id":"15-disclaimer-of-warranty","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"15. Disclaimer of Warranty","title":"GNU General Public License","text":"WARRANTY PROGRAM, EXTENT PERMITTED APPLICABLE LAW. EXCEPT OTHERWISE STATED WRITING COPYRIGHT HOLDERS /PARTIES PROVIDE PROGRAM “” WITHOUT WARRANTY KIND, EITHER EXPRESSED IMPLIED, INCLUDING, LIMITED , IMPLIED WARRANTIES MERCHANTABILITY FITNESS PARTICULAR PURPOSE. ENTIRE RISK QUALITY PERFORMANCE PROGRAM . PROGRAM PROVE DEFECTIVE, ASSUME COST NECESSARY SERVICING, REPAIR CORRECTION.","code":""},{"path":"/LICENSE.html","id":"16-limitation-of-liability","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"16. Limitation of Liability","title":"GNU General Public License","text":"EVENT UNLESS REQUIRED APPLICABLE LAW AGREED WRITING COPYRIGHT HOLDER, PARTY MODIFIES /CONVEYS PROGRAM PERMITTED , LIABLE DAMAGES, INCLUDING GENERAL, SPECIAL, INCIDENTAL CONSEQUENTIAL DAMAGES ARISING USE INABILITY USE PROGRAM (INCLUDING LIMITED LOSS DATA DATA RENDERED INACCURATE LOSSES SUSTAINED THIRD PARTIES FAILURE PROGRAM OPERATE PROGRAMS), EVEN HOLDER PARTY ADVISED POSSIBILITY DAMAGES.","code":""},{"path":"/LICENSE.html","id":"17-interpretation-of-sections-15-and-16","dir":"","previous_headings":"TERMS AND CONDITIONS","what":"17. Interpretation of Sections 15 and 16","title":"GNU General Public License","text":"disclaimer warranty limitation liability provided given local legal effect according terms, reviewing courts shall apply local law closely approximates absolute waiver civil liability connection Program, unless warranty assumption liability accompanies copy Program return fee. END TERMS CONDITIONS","code":""},{"path":"/LICENSE.html","id":"how-to-apply-these-terms-to-your-new-programs","dir":"","previous_headings":"","what":"How to Apply These Terms to Your New Programs","title":"GNU General Public License","text":"develop new program, want greatest possible use public, best way achieve make free software everyone can redistribute change terms. , attach following notices program. safest attach start source file effectively state exclusion warranty; file least “copyright” line pointer full notice found. Also add information contact electronic paper mail. program terminal interaction, make output short notice like starts interactive mode: hypothetical commands show w show c show appropriate parts General Public License. course, program’s commands might different; GUI interface, use “box”. also get employer (work programmer) school, , sign “copyright disclaimer” program, necessary. information , apply follow GNU GPL, see <http://www.gnu.org/licenses/>. GNU General Public License permit incorporating program proprietary programs. program subroutine library, may consider useful permit linking proprietary applications library. want , use GNU Lesser General Public License instead License. first, please read <http://www.gnu.org/philosophy/--lgpl.html>.","code":"<one line to give the program's name and a brief idea of what it does.> Copyright (C) <year>  <name of author>  This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.  This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.  You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>. <program>  Copyright (C) <year>  <name of author> This program comes with ABSOLUTELY NO WARRANTY; for details type 'show w'. This is free software, and you are welcome to redistribute it under certain conditions; type 'show c' for details."},{"path":"/articles/BinRW.html","id":"prior-predictive-distribution","dir":"Articles","previous_headings":"","what":"Prior predictive distribution","title":"Binomial random walk model","text":"First, sample prior predictive distribution inspect prior generate fake data.","code":"fit0 <- sample_prior(model,                      N_patient = N_patient,                      t_max = t_max,                      chains = 1,                      refresh = 0) check_hmc_diagnostics(fit0) #>  #> Divergences: #> 0 of 1000 iterations ended with a divergence. #>  #> Tree depth: #> 0 of 1000 iterations saturated the maximum tree depth of 10. #>  #> Energy: #> E-BFMI indicated no pathological behavior. # pairs(fit0, pars = pars$Population) plot(fit0, pars = c(pars$Population, paste0(pars$Patient, \"[1]\")), plotfun = \"hist\") #> `stat_bin()` using `bins = 30`. Pick better value with `binwidth`."},{"path":"/articles/BinRW.html","id":"generating-fake-data","dir":"Articles","previous_headings":"","what":"Generating fake data","title":"Binomial random walk model","text":"generate fake data choosing draw one prior predictive distribution. artificially produce missing values make data representative observe real life. , generate missingness using two-state Markov Chain. inspect time-series patients.","code":"p_mis <- .1 p_obs_obs <- .9 horizon <- 5  # Take one draw (different draws corresponds to different a priori pattern in the data) draw <- 4  true_param <- rstan::extract(fit0, pars = c(pars$Population, pars$Patient)) %>%   HuraultMisc::extract_draws(draw)  yrep <- rstan::extract(fit0, pars = \"y_rep\")[[1]]  fd <- get_index2(t_max) %>%   mutate(Score = yrep[draw, ]) fd <- lapply(1:N_patient,              function(i) {                sub_fd <- filter(fd, Patient == i)                id_mis <- generate_missing(t_max[i] - horizon, type = \"markovchain\", p_mis = p_mis, p_obs_obs = p_obs_obs)                id_mis <- c(id_mis, rep(FALSE, horizon)) # don't generate missing values for prediction horizon                sub_fd[id_mis, \"Score\"] <- NA                return(sub_fd)              }) %>%   bind_rows() lapply(sort(sample(1:N_patient, min(N_patient, 4))),        function(pid) {          fd %>%            filter(Patient == pid) %>%            ggplot(aes(x = Time, y = Score)) +            geom_line() +            geom_point() +            coord_cartesian(ylim = c(0, params$max_score)) +            labs(title = paste0(\"Patient \", pid)) +            theme_bw(base_size = 15)        }) %>%   plot_grid(plotlist = ., ncol = 2)"},{"path":"/articles/BinRW.html","id":"fitting-data-to-the-model","dir":"Articles","previous_headings":"","what":"Fitting data to the model","title":"Binomial random walk model","text":"Now, perform fake data check, .e. fitting model fake data extracted prior predictive distribution see can recover true parameters.","code":"train <- fd %>%   group_by(Patient) %>%   filter(Time <= max(Time) - horizon) %>%   ungroup() %>%   drop_na()  test <- fd %>%   group_by(Patient) %>%   filter(Time > max(Time) - horizon) %>%   mutate(Horizon = Time - min(Time) + 1) %>%   ungroup() %>%   drop_na()  fit <- EczemaFit(model,                  train = train,                  test = test,                  chains = 1, # only one chain for speed                  refresh = 0)"},{"path":"/articles/BinRW.html","id":"diagnostics","dir":"Articles","previous_headings":"Fitting data to the model","what":"Diagnostics","title":"Binomial random walk model","text":"look evidence absence convergences inspecting divergences trace plots.","code":"check_hmc_diagnostics(fit) #>  #> Divergences: #> 0 of 1000 iterations ended with a divergence. #>  #> Tree depth: #> 0 of 1000 iterations saturated the maximum tree depth of 10. #>  #> Energy: #> E-BFMI indicated no pathological behavior. pairs(fit, pars = pars$Population) #> Warning in par(usr): argument 1 does not name a graphical parameter  #> Warning in par(usr): argument 1 does not name a graphical parameter  #> Warning in par(usr): argument 1 does not name a graphical parameter plot(fit, pars = pars$Population, plotfun = \"trace\")"},{"path":"/articles/BinRW.html","id":"posterior-estimates","dir":"Articles","previous_headings":"Fitting data to the model","what":"Posterior estimates","title":"Binomial random walk model","text":"visualise posterior estimates compare prior.  can also quantify influence prior posterior estimates computing posterior shrinkage Mahalanobis distance mean posterior prior. posterior shrinkage roughly quantifies much model learning, defined parameter \\(\\theta\\) \\(1 - \\frac{\\operatorname{Var}(\\theta_\\text{post})}{\\operatorname{Var}(\\theta_\\text{prior}}\\). distance prior posterior can used assess whether prior informative , distance greater 2 3 interpreted posterior “included” prior.","code":"par0 <- extract_parameters(fit0, pars = pars_of_interest) par <- extract_parameters(fit, pars = pars_of_interest) HuraultMisc::plot_prior_posterior(par0, par, pars = pars$Population) HuraultMisc::plot_prior_influence(par0, par, pars = unlist(pars_of_interest))"},{"path":"/articles/BinRW.html","id":"can-we-recover-the-true-parameters","dir":"Articles","previous_headings":"Fitting data to the model","what":"Can we recover the true parameters?","title":"Binomial random walk model","text":"compare posterior estimates true parameters see algorithm worked expected.  can also quantify “accuracy” posterior estimates computing coverage probability parameters model, proportion parameters x% credible interval includes true value. instance, expect approximately 50% parameters 50% credible interval including true value.","code":"par %>%     left_join(true_param, by = c(\"Variable\" = \"Parameter\", \"Index\")) %>%     rename(True = Value) %>%     ggplot(aes(x = Variable, group = Index)) +     geom_pointrange(aes(y = Mean, ymin = `5%`, ymax = `95%`, colour = \"Posterior\"),                     position = position_dodge(width = .8)) +     geom_point(aes(y = True, colour = \"Truth\"), size = 2,                position = position_dodge(width = .8)) +     coord_flip() +     scale_colour_manual(values = c(\"Posterior\" = \"black\", \"Truth\" = \"#E69F00\")) +     labs(x = \"\", y = \"Estimate\", colour = \"\") +     theme_bw(base_size = 20) +     theme(legend.position = \"top\") HuraultMisc::plot_coverage(do.call(cbind, rstan::extract(fit, pars = true_param[[\"Parameter\"]])),                            true_param[[\"Value\"]])"},{"path":"/articles/BinRW.html","id":"posterior-predictive-trajectory","dir":"Articles","previous_headings":"Fitting data to the model","what":"Posterior predictive trajectory","title":"Binomial random walk model","text":"inspect posterior predictive trajectory detect discrepancies data model’s simulations.","code":"ms <- min(1, 20 / (params$max_score + 1)) pl <- lapply(sort(sample(1:N_patient, 4)),        function(pid) {          tryCatch({            plot_ppc_traj_pmf(fit, train = train, test = test, patient_id = pid, max_score = params$max_score, max_scale = ms) +            labs(title = paste0(\"Patient \", pid))          }, error = function(e) {NULL})        }) plot_grid(   get_legend(pl[[1]] + theme(legend.position = \"top\")),   plot_grid(plotlist = lapply(pl, function(x) {x + theme(legend.position = \"none\")}),             ncol = 2),   ncol = 1, rel_heights = c(.1, .9) )"},{"path":"/articles/BinRW.html","id":"performance","dir":"Articles","previous_headings":"Fitting data to the model","what":"Performance","title":"Binomial random walk model","text":"Finally, compute lpd RPS observation test set plot average metrics function prediction horizon. expect lower performance (decreased lpd, increased RPS) increasing prediction horizon.","code":"test <- test %>%   mutate(lpd = extract_lpd(fit),          RPS = extract_RPS(fit))  test %>%   pivot_longer(cols = c(\"lpd\", \"RPS\"), names_to = \"Metric\", values_to = \"Value\") %>%   group_by(Metric, Horizon) %>%   summarise(Mean = mean(Value), SD = sd(Value), SE = SD / sqrt(n())) %>%   ggplot(aes(x = Horizon, y = Mean, ymin = Mean - SE, ymax = Mean + SE)) +   geom_pointrange() +   facet_wrap(vars(Metric), scales = \"free\") +   theme_bw(base_size = 15) #> `summarise()` has grouped output by 'Metric'. You can override using the #> `.groups` argument."},{"path":"/articles/ContinuousModels.html","id":"generate-fake-data","dir":"Articles","previous_headings":"","what":"Generate fake data","title":"Continuous models","text":"model considered supposed used baselines, generate fake data different generating process. enforce constrain data bounded 0 100, generate data logit scale, take inverse logit multiply 100. also add missing values make data representative observed real life. can inspect time-series handful patients.  Finally, split data training testing set, testing set correspond last observations time-series.","code":"N_patient <- 20 t_max <- rpois(N_patient, 50) y0 <- rbeta(N_patient, 5, 5) mu_alpha <- 0.8 phi_alpha <- 10 alpha <- 0.8 b <- rnorm(N_patient, 0, 0.1) sigma <- 0.2  df <- lapply(1:N_patient,              function(i) {                y <- rep(NA, t_max[i])                err <- rnorm(t_max[i] - 1, 0, sigma)                y[1] <- HuraultMisc::logit(y0[i])                for (t in 2:t_max[i]) {                  y[t] = alpha * y[t - 1] + b[i] + err[t - 1]                }                y <- HuraultMisc::inv_logit(y) * max_score                t_mis <- generate_missing(t_max[i], type = \"markovchain\", p_mis = 0.2, p_obs_obs = 0.8)                y[t_mis] <- NA                                data.frame(Patient = i,                           Time = 1:t_max[i],                           Score = y)              }) %>%   bind_rows() smp_pt <- sort(sample(1:N_patient, 4)) lapply(smp_pt,        function(pid) {          df %>%            filter(Patient == pid) %>%            ggplot(aes(x = Time, y = Score)) +            geom_line() +            geom_point() +            coord_cartesian(ylim = c(0, max_score)) +            labs(title = paste0(\"Patient \", pid)) +            theme_bw(base_size = 15)        }) %>%   plot_grid(plotlist = ., ncol = 2) horizon <- 10  df <- df %>%   drop_na() %>%   group_by(Patient) %>%   mutate(LastTime = max(Time) - horizon,          Label = case_when(Time <= LastTime ~ \"Training\",                            TRUE ~ \"Testing\")) %>%   ungroup()  train <- df %>% filter(Label == \"Training\") test <- df %>%   filter(Label == \"Testing\") %>%   mutate(Horizon = Time - LastTime)"},{"path":"/articles/ContinuousModels.html","id":"fit-models","dir":"Articles","previous_headings":"","what":"Fit models","title":"Continuous models","text":"fit different models data, inspect whether divergences sampling. , compute log predictive density observation different models plot average performance. give sense scale, add performance uniform forecast historical forecast plot.  , best model terms --sample lpd MixedAR1. plot posterior predictive trajectory model patients inspect well fits data.","code":"res <- lapply(mdl_names,               function(mdl) {                                  model <- EczemaModel(mdl, max_score = max_score, discrete = FALSE)                                  fit <- EczemaFit(model,                                  train = train,                                  test = test,                                  chains = 1,                                  refresh = 0)                                  diag <- data.frame(Divergences = get_num_divergent(fit),                                    MaxTreeDepth = get_num_max_treedepth(fit),                                    Model = mdl)                                  perf <- test %>%                   add_predictions(fit, discrete = FALSE, include_samples = FALSE) %>%                   mutate(Model = mdl)                                  return(list(Fit = fit,                             Diagnostics = diag,                             Performance = perf))                                })  diag <- lapply(res, function(x) {x$Diagnostics}) %>% bind_rows() perf <- lapply(res, function(x) {x$Performance}) %>% bind_rows()  knitr::kable(diag) perf <- bind_rows(perf,                   add_uniform_pred(test, max_score, discrete = FALSE) %>%                     mutate(Model = \"uniform\"),                   add_historical_pred(test, train, max_score, discrete = FALSE) %>%                     mutate(Model = \"historical\"))  mean_perf <- perf %>%   group_by(Model) %>%   summarise(Mean = mean(lpd), SE = sd(lpd) / sqrt(n())) %>%   ungroup() %>%   mutate(Model = forcats::fct_reorder(factor(Model), Mean))  ggplot(data = mean_perf,        aes(x = Model, y = Mean, ymin = Mean - SE, ymax = Mean + SE)) +   geom_pointrange() +   labs(y = \"lpd\", x = \"\") +   theme_bw(base_size = 15) best_model <- mean_perf %>%   filter(Mean == max(Mean)) %>%   pull(Model) fit_best <- res[[which(mdl_names == best_model)]]$Fit  pl <- lapply(smp_pt,        function(pid) {          plot_ppc_traj_fanchart(fit_best, train = train, test = test, patient_id = pid, max_score = max_score) +            labs(title = paste0(\"Patient \", pid))        }) plot_grid(   get_legend(pl[[1]] + theme(legend.position = \"top\")),   plot_grid(plotlist = lapply(pl, function(x) {x + theme(legend.position = \"none\")}),             ncol = 2),   ncol = 1, rel_heights = c(.1, .9) )"},{"path":"/articles/ExtendModels.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Extending EczemaPred models","text":"EczemaPred package provides collection “simple” statistical models addresses common challenges working observational eczema severity data: multiple time-series (longitudinal data) potentially patient-dependent parameters irregular measurements missing values imprecise measurements (cf. measurement error) small data (cf. uncertainty quantification) discrete ordinal (notably bounded) outcomes severity scores aggregates multiple items , models can extended investigate diverse research questions. vignette describes use package modify pre-processing model extended.","code":"library(EczemaPred) library(dplyr)"},{"path":"/articles/ExtendModels.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Extending EczemaPred models","text":"package uses S3 object oriented programming system R allow inheritance polymorphism. details S3 OOP system, can check Hadley Wickham’s book. package provides set generics can useful extending models: default_prior(): Provide default priors validate_prior(): Check prior correctly specified prepare_standata(): Prepare data input Stan sampler list_parameters(): List parameters model print_prior(): display priors print method (optional) EczemaFit(): Fit model (default generic valid models provided package) sample_prior(): Sample prior predictive distribution model (default generic valid models provided package)","code":""},{"path":"/articles/ExtendModels.html","id":"example","dir":"Articles","previous_headings":"","what":"Example","title":"Extending EczemaPred models","text":"example, let’s assume like include additional covariates BinRW model, sex patient (variable sex, coded binary, coefficient beta_sex).","code":""},{"path":"/articles/ExtendModels.html","id":"modifying-the-stan-code","dir":"Articles","previous_headings":"Example","what":"Modifying the Stan code","title":"Extending EczemaPred models","text":"original Stan model, available , mean: Including sex data block: int<lower = 0, upper = 1> sex[N_pt]; Including beta_sex parameters block: real beta_sex; Changing latent dynamic transformed parameters block, .e. changing logit_lat[t] = logit_lat[t - 1] + sigma * eta[t]; logit_lat[t] = logit_lat[t - 1] + beta_sex * sex[k] sigma * eta[t]; Include prior beta_sex model block, example: sex ~ normal(0, 1). prior can also specified data data block real prior_beta_sex[2]; model block sex ~ normal(prior_beta_sex[1], prior_beta_sex[2]); Let’s call new model BinRW2.","code":""},{"path":"/articles/ExtendModels.html","id":"updating-the-pre-processing","dir":"Articles","previous_headings":"Example","what":"Updating the pre-processing","title":"Extending EczemaPred models","text":"One way use package infrastructure minimise amount new code write create new model class BinRW2 inherits class BinRW. also write BinRW2 methods default_prior, validate_prior print_prior makes use NextMethod() call methods parent class BinRW. Similarly can write method list_parameters: finally, need write method prepare_standata, need provide sex data addition data required “BinRW”.","code":"BinRW2 <- function(max_score, prior = NULL) {      model <- EczemaModel(\"BinRW\", max_score = max_score)      model$name <- \"BinRW2\"   model$stanmodel <- \"path_to_stancode\"   class(model) <- c(\"BinRW2\", class(model))      model$prior <- default_prior(model) # Overwrite BinRW prior   model <- replace_prior(model, prior = prior) # Overwrite BinRW2 default prior   validate_prior(model) # Check BinRW2 prior      return(model)  }  default_prior.BinRW2 <- function(model) {   c(list(beta_sex = c(0, 1)),     NextMethod()) }  validate_prior.BinRW2 <- function(model) {   prior <- model$prior   stopifnot(is.list(prior),             \"beta_sex\" %in% names(prior),             is.numeric(prior$beta_sex),             length(prior$beta_sex) == 2,             prior$beta_sex[2] > 0)   NextMethod() }  print_prior.BinRW2 <- function(model, digits = 2) {   print_distribution(\"beta_sex\", \"normal\", model$prior$beta_sex, digits = digits)   NextMethod() } list_parameters.BinRW2 <- function(model) {   pars <- NextMethod()   pars$Population <- c(pars$Population, \"beta_sex\")   return(pars) } prepare_standata.BinRW2 <- function(model, train, test = NULL, sex) {   out <- NextMethod()   stopifnot(out$N_pt == length(sex),             all(sex %in% c(0, 1)))   out <- c(out, list(sex = sex))   return(out) }"},{"path":"/articles/ExtendModels.html","id":"fitting-the-model","dir":"Articles","previous_headings":"Example","what":"Fitting the model","title":"Extending EczemaPred models","text":"Now everything place, can use generics sample prior predictive distribution model fit data like EczemaPred models. sample prior predictive distribution, need generate empty dataset pass prepare_standata call rstan::stan (code put function sample_prior.BinRW2). fit model real data, assuming training set optionally testing set, just need call prepare_standata rstan::stan (equivalent EczemaFit function).","code":"max_score <- 100  (model <- BinRW2(max_score = max_score)) #> BinRW2 model (discrete) #> max_score = 100  #> Prior:  #> - beta_sex ~ normal(0,1) #> - sigma ~ normal+(0,0.4) #> - mu_logit_y0 ~ normal(0,1) #> - sigma_logit_y0 ~ normal(0,1.5)  list_parameters(model) #> $Population #> [1] \"sigma\"          \"mu_logit_y0\"    \"sigma_logit_y0\" \"beta_sex\"       #>  #> $Patient #> [1] \"logit_y0\" #>  #> $PatientTime #> [1] \"y_lat\" \"y_rep\" #>  #> $Observation #> [1] \"log_lik\" #>  #> $Test #> [1] \"y_pred\"  \"lpd\"     \"cum_err\" N_patient <- 10 t_max <- rpois(N_patient, 20) sex <- rbinom(N_patient, 1, 0.5)  tmp <- make_empty_data(N_patient = N_patient,                        t_max = t_max,                        max_score = model$max_score,                        discrete = model$discrete)  data_stan <- prepare_standata(model, train = tmp[[\"Training\"]], test = tmp[[\"Testing\"]], sex = sex) %>%   c(list(run = 0))  if (FALSE) {   fit_prior <- rstan::stan(model$stanmodel, data = data_stan, ...) } if (FALSE) {   train <- get_index2(t_max) %>%     mutate(Score = rstan::extract(fit_prior, pars = \"y_rep\")[[1]][10, ]) # fake data for the example      data_stan <- prepare_standata(model, train = train, sex = sex) %>%     c(list(run = 1))      fit <- rstan::stan(model$stanmodel, data = data_stan, ...) }"},{"path":"/articles/MC.html","id":"prior-predictive-distribution","dir":"Articles","previous_headings":"","what":"Prior predictive distribution","title":"Markov Chain model","text":"Stan model works pairs successive states rather time-series sequence. generate time-series prior predictive distribution, can consider possible states time-point. default prior used symmetric uniform Dirichlet distribution (Dirichlet distribution concentration parameters equal 1). can inspect empirical distribution transition probabilities.  can also plot expected transition matrix heatmap.  categories ordinal, may assume probabilities transitioning state 5 1 much smaller probability transitioning state 5 4. case, use RBF-like Dirichlet prior transition probabilities, example:  prior information value (number pseudo-count) prior , favours neighbouring transitions.","code":"df0 <- data.frame(y0 = rep(1:params$K, each = params$t_max),                   y1 = 1, # does not matter                   dt = 1) fit_prior1 <- sample_prior(model, data = df0, chains = 1, refresh = 0) rstan::plot(fit_prior1, pars = \"p\", plotfun = \"hist\") plot_transition_MC(fit_prior1) prior_RBF_MC <- function(K, alpha, l) {   # RBF-like Dirichlet prior   # Each transition pmf is normalised to a pseudo-count of K   #   # Args:   # K : number of states   # alpha: scaling factor, determining the concentration of the Dirichlet distribution   # l: length scale   #   # Returns:   # K*K matrix      p <- matrix(NA, nrow = K, ncol = K)   for (i in 1:K) {     for (j in 1:K) {       p[i, j] <- exp(-(i - j)^2 / 2 / l^2)     }     p[i, ] <- p[i, ] / sum(p[i, ])   }   p <- alpha * K * p   return(list(p = p)) }  model2 <- EczemaModel(\"MC\", K = params$K, prior = prior_RBF_MC(params$K, 1, 1))  fit_prior2 <- sample_prior(model2, data = df0, chains = 1, refresh = 0) #> Warning: There were 863 divergent transitions after warmup. See #> https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup #> to find out why this is a problem and how to eliminate them. #> Warning: Examine the pairs() plot to diagnose sampling problems #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  plot_transition_MC(fit_prior2)"},{"path":"/articles/MC.html","id":"generating-fake-data","dir":"Articles","previous_headings":"","what":"Generating fake data","title":"Markov Chain model","text":"following, consider uniform Dirichlet prior. can generate sequence taking draw sample prior predictive distribution assuming initial state following parameters used generate sequence can extracted : practice, values often missing. can generate missing values following:","code":"draw <- 501 initial <- 2  yrep <- rstan::extract(fit_prior1, pars = \"y_rep\")[[1]]  yrep1 <- matrix(yrep[draw, ], ncol = params$t_max, byrow = TRUE)  # Assemble sequence out <- rep(NA, params$t_max) out[1] <- initial for (i in 1:(params$t_max - 1)) {   out[i + 1] = yrep1[out[i], i] } df <- data.frame(t = 1:params$t_max, y = out) true_param <- rstan::extract(fit_prior1, pars = \"p\") %>%   HuraultMisc::extract_draws(draw) t_mis <- which(generate_missing(params$t_max, type = \"random\", p_mis = 0.2))  df %>%   mutate(y = replace(y, t %in% t_mis, NA)) %>%   ggplot(aes(x = t, y = y)) +   geom_point() +   geom_path() +   theme_bw(base_size = 15) df <- df %>% filter(!(t %in% t_mis))"},{"path":"/articles/MC.html","id":"fake-data-check","dir":"Articles","previous_headings":"","what":"Fake data check","title":"Markov Chain model","text":"Using fake dataset, can fit model try recover transition probabilities. can also hold observations evaluate performance model.","code":"df_MC <- df %>%   rename(y0 = y) %>%   mutate(y1 = lead(y0),          dt = lead(t) - t) %>%   drop_na()  train <- df_MC %>% filter(t <= 0.9 * params$t_max) test <- df_MC %>% filter(t > 0.9 * params$t_max)  fit <- EczemaFit(model,                  train = train,                  test = test,                  chains = 1,                  refresh = 0)"},{"path":"/articles/MC.html","id":"diagnostics","dir":"Articles","previous_headings":"Fake data check","what":"Diagnostics","title":"Markov Chain model","text":"First, look evidence absence convergences inspecting divergences trace plots.","code":"check_hmc_diagnostics(fit) #>  #> Divergences: #>  #> Tree depth: #>  #> Energy:  pairs(fit, pars = paste0(\"p[1,\", 1:params$K, \"]\")) # transitions probabilities from state 1 #> Warning in par(usr): argument 1 does not name a graphical parameter  #> Warning in par(usr): argument 1 does not name a graphical parameter  #> Warning in par(usr): argument 1 does not name a graphical parameter  #> Warning in par(usr): argument 1 does not name a graphical parameter  #> Warning in par(usr): argument 1 does not name a graphical parameter plot(fit, pars = paste0(\"p[1,\", 1:params$K, \"]\"), plotfun = \"trace\")"},{"path":"/articles/MC.html","id":"posterior-estimates","dir":"Articles","previous_headings":"Fake data check","what":"Posterior estimates","title":"Markov Chain model","text":", visualise posterior estimates compare prior.  can also quantify influence prior posterior estimates computing posterior shrinkage Mahalanobis distance mean posterior prior. posterior shrinkage roughly quantifies much model learning, defined parameter \\(\\theta\\) \\(1 - \\frac{\\operatorname{Var}(\\theta_\\text{post})}{\\operatorname{Var}(\\theta_\\text{prior}}\\). distance prior posterior can used assess whether prior informative , distance greater 2 3 interpreted posterior “included” prior.  also visualise expected transition matrix:","code":"par0 <- HuraultMisc::summary_statistics(fit_prior1, pars = \"p\") par <- HuraultMisc::summary_statistics(fit, pars = \"p\") HuraultMisc::plot_prior_posterior(par0, par, pars = \"p\", match_exact = FALSE) HuraultMisc::plot_prior_influence(par0, par, pars = \"p\", match_exact = FALSE) plot_transition_MC(fit)"},{"path":"/articles/MC.html","id":"can-we-recover-the-true-parameters","dir":"Articles","previous_headings":"Fake data check","what":"Can we recover the true parameters?","title":"Markov Chain model","text":"plot posterior estimates alongside true parameters values used generate data.  can also quantify “accuracy” posterior estimates computing coverage probability parameters model, proportion parameters x% credible interval includes true value. instance, expect approximately 50% parameters 50% credible interval including true value.","code":"HuraultMisc::summary_statistics(fit, \"p\") %>%   full_join(true_param, by = c(\"Variable\" = \"Parameter\", \"Index\")) %>%   rename(True = Value) %>%   ggplot(aes(x = Variable)) +   geom_pointrange(aes(y = Mean, ymin = `5%`, ymax = `95%`, colour = \"Posterior\")) +   geom_point(aes(y = True, colour = \"Truth\"), size = 2) +   coord_flip(ylim = c(0, 1)) +   scale_colour_manual(values = c(\"Posterior\" = \"black\", \"Truth\" = \"#E69F00\")) +   labs(x = \"\", y = \"Estimate\", colour = \"\") +   theme_bw(base_size = 20) +   theme(legend.position = \"top\") HuraultMisc::plot_coverage(do.call(cbind, rstan::extract(fit, pars = true_param[[\"Parameter\"]])),                            true_param[[\"Value\"]])"},{"path":"/articles/MC.html","id":"performance","dir":"Articles","previous_headings":"Fake data check","what":"Performance","title":"Markov Chain model","text":"Finally, can compute lpd RPS observation test set, metrics later compared another model.","code":"test <- test %>%   mutate(lpd = extract_lpd(fit),          RPS = extract_RPS(fit))  test %>%   pivot_longer(cols = c(\"lpd\", \"RPS\"), names_to = \"Metric\", values_to = \"Value\") %>%   group_by(Metric) %>%   summarise(Mean = mean(Value), SD = sd(Value), SE = SD / sqrt(n())) #> # A tibble: 2 × 4 #>   Metric   Mean    SD     SE #>   <chr>   <dbl> <dbl>  <dbl> #> 1 lpd    -1.53  0.634 0.158  #> 2 RPS     0.175 0.101 0.0253"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Guillem Hurault. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hurault G, Stalder J, Mery S, Delarue , Saint Aroman M, Josse G, Tanaka R (2022). “EczemaPred: computational framework personalised prediction eczema severity dynamics.” Clinical Translational Allergy, 12(3), e12140. doi:10.1002/clt2.12140.","code":"@Article{,   title = {EczemaPred: A computational framework for personalised prediction of eczema severity dynamics},   author = {Guillem Hurault and Jean François Stalder and Sophie Mery and Alain Delarue and Markéta {Saint Aroman} and Gwendal Josse and Reiko J. Tanaka},   journal = {Clinical and Translational Allergy},   year = {2022},   volume = {12},   number = {3},   pages = {e12140},   doi = {10.1002/clt2.12140}, }"},{"path":"/index.html","id":"eczemapred","dir":"","previous_headings":"","what":"Predicting the Evolution of Eczema Severity","title":"Predicting the Evolution of Eczema Severity","text":"EczemaPred R package implementing models serve building blocks predicting evolution eczema severity, provides set generic functions manipulate models. models implemented probabilistic programming language Stan. EczemaPred first introduced Hurault et al. (2022), “EczemaPred: computational framework personalised prediction eczema severity dynamics”, published Clinical Translational Allergy. analysis code research article available .","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Predicting the Evolution of Eczema Severity","text":"package requires RStan C++ toolchain, can installed following instructions. , package can installed typing following commands R: install specific version, example initial release (v0.1.0): package can take minutes install models needs compiled (compilation required using package). Many warnings may displayed compilation can safely ignored. NB: EczemaPred requires HuraultMisc, personal function library, work.","code":"devtools::install_github(\"ghurault/EczemaPred\") devtools::install_github(\"ghurault/EczemaPred@v0.1.0\")"},{"path":"/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Predicting the Evolution of Eczema Severity","text":"package loaded : working local, multicore CPU excess RAM, may want call options(mc.cores = parallel::detectCores()) run Stan multiple cores parallel. list functions datasets available package website typing help(package = \"EczemaPred\"). Examples package can used provided vignettes (long form documentation). Basic knowledge Bayesian modelling Stan package rstan required analyse models’ outputs. Stan documentation available . NB: purpose package abstract implementation user, R code Stan code can accessed R/ inst/stan directories, respectively.","code":"library(EczemaPred)"},{"path":"/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Predicting the Evolution of Eczema Severity","text":"open source version EczemaPred licensed GPL v3 license, can seen LICENSE file. closed source version EczemaPred also available without restrictions GPL v3 license software usage agreement Imperial College London. information, please contact Diana Yin.","code":""},{"path":"/reference/AR1.html","id":null,"dir":"Reference","previous_headings":"","what":"Autoregressive model (order 1) — AR1","title":"Autoregressive model (order 1) — AR1","text":"Autoregressive model (order 1)","code":""},{"path":"/reference/AR1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Autoregressive model (order 1) — AR1","text":"max_score Maximum value score can take discrete Whether use discrete normal distribution. used check whether data discrete , rounding predictions (cf. testing). prior Named list model's priors. NULL, uses default prior model (see default_prior()).","code":""},{"path":"/reference/AR1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Autoregressive model (order 1) — AR1","text":"Details model available paper. model takes input continuous score defined 0 max_score. model naive likelihood non-truncated discretised (discrete = TRUE). result, sampling prior predictive distribution can challenging score near bounds variance sufficiently large. details see vignette. model naive trained non-truncated distribution details see vignette.","code":""},{"path":"/reference/AR1.html","id":"parameters","dir":"Reference","previous_headings":"","what":"Parameters","title":"Autoregressive model (order 1) — AR1","text":"sigma: Standard deviation autoregression slope: Autocorrelation parameter intercept: Intercept y_inf: Autoregression mean y_mis: Missing values See list_parameters(model = \"AR1\") details.","code":""},{"path":"/reference/AR1.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Autoregressive model (order 1) — AR1","text":"priors passed named list elements sigma, y_inf slope specifying priors corresponding parameters. element list vector length 2, containing values x1 x2, x2 > 0, : sigma / max_score ~ normal+(x1, x2). y_inf / max_score ~ normal(x1, x2). slope ~ beta(x1, x2). NB: sigma, usually x1=0 define half-normal distribution since parameter constrained positive. NB: slope, x1 x2 must positive.","code":""},{"path":"/reference/AR1.html","id":"default-priors","dir":"Reference","previous_headings":"","what":"Default priors","title":"Autoregressive model (order 1) — AR1","text":"default prior sigma translates width predictive distribution max_score. default prior y_inf covers full range score. default prior slope uniform 0-1.","code":""},{"path":"/reference/AR1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Autoregressive model (order 1) — AR1","text":"","code":"EczemaModel(\"AR1\", max_score = 100) #> AR1 model (continuous) #> max_score = 100  #> Prior:  #> - sigma / max_score ~ normal+(0,0.1) #> - slope ~ beta(1,1) #> - y_inf / max_score ~ normal(0.5,0.25)"},{"path":"/reference/BinMC.html","id":null,"dir":"Reference","previous_headings":"","what":"Binomial Markov Chain model — BinMC","title":"Binomial Markov Chain model — BinMC","text":"state-space model defined Binomial measurement error latent Markov Chain. details see BinRW vignette.","code":""},{"path":"/reference/BinMC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Binomial Markov Chain model — BinMC","text":"max_score Maximum value score can take prior Named list model's priors. NULL, uses default prior model (see default_prior()).","code":""},{"path":"/reference/BinMC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Binomial Markov Chain model — BinMC","text":"Details model available paper.","code":""},{"path":[]},{"path":"/reference/BinMC.html","id":"population-parameters-","dir":"Reference","previous_headings":"","what":"Population parameters:","title":"Binomial Markov Chain model — BinMC","text":"sigma: Standard deviation evolution ss1 mu_logit_p10: Population logit mean p10 sigma_logit_p10: Population logit standard deviation p10","code":""},{"path":"/reference/BinMC.html","id":"patient-dependent-parameters-","dir":"Reference","previous_headings":"","what":"Patient-dependent parameters:","title":"Binomial Markov Chain model — BinMC","text":"p10: Probability transitioning state 1 state 0 logit_p10: logit p10 logit_tss1_0: Initial condition logit(ss1 * (1 + p10))","code":""},{"path":"/reference/BinMC.html","id":"observation-dependent-patient-and-time-dependent-parameters-","dir":"Reference","previous_headings":"","what":"Observation-dependent (patient- and time-dependent) parameters:","title":"Binomial Markov Chain model — BinMC","text":"p01: Probability transitioning state 0 state 1 lambda: Mobility Markov Chain (eigenvalue transition matrix) ss1: Steady state probability state 1 y_lat: Latent score (probability) See list_parameters(model = \"BinMC\") details.","code":""},{"path":"/reference/BinMC.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Binomial Markov Chain model — BinMC","text":"priors passed named list elements sigma, mu_logit_p10 sigma_logit_p10 specifying priors corresponding parameters. element list vector length 2, containing values x1 x2, x2 > 0, : sigma ~ normal+(x1, x2) mu_logit_p10 ~ normal(x1, x2) sigma_logit_p10 ~ normal+(x1, x2) logit_tss1_0 ~ normal(x1, x2) NB: sigma sigma_logit_p10, usually x1=0 define half-normal distribution since parameter constrained positive.","code":""},{"path":"/reference/BinMC.html","id":"default-priors","dir":"Reference","previous_headings":"","what":"Default priors","title":"Binomial Markov Chain model — BinMC","text":"default prior sigma translates odd ratio increment 5 (~ 2 * upper bound prior). default priors mu_logit_p10 sigma_logit_p10 translate approximately uniform prior p10. prior initial condition ss1 hard coded function p10.","code":""},{"path":"/reference/BinMC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Binomial Markov Chain model — BinMC","text":"","code":"EczemaModel(\"BinMC\", max_score = 100) #> BinMC model (discrete) #> max_score = 100  #> Prior:  #> - sigma ~ normal+(0,0.4) #> - mu_logit_p10 ~ normal(0,1) #> - sigma_logit_p10 ~ normal+(0,1.5) #> - logit_tss1_0 ~ normal(-1,1)"},{"path":"/reference/BinRW.html","id":null,"dir":"Reference","previous_headings":"","what":"Binomial random walk model — BinRW","title":"Binomial random walk model — BinRW","text":"state-space model defined Binomial measurement error latent random walk. details see vignette.","code":""},{"path":"/reference/BinRW.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Binomial random walk model — BinRW","text":"max_score Maximum value score can take prior Named list model's priors. NULL, uses default prior model (see default_prior()).","code":""},{"path":"/reference/BinRW.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Binomial random walk model — BinRW","text":"Details model available paper.","code":""},{"path":[]},{"path":"/reference/BinRW.html","id":"population-parameters-","dir":"Reference","previous_headings":"","what":"Population parameters:","title":"Binomial random walk model — BinRW","text":"sigma: Standard deviation random walk (logit scale) mu_logit_y0: Population mean initial condition (logit scale) sigma_logit_y0: Population standard deviation initial condition (logit scale)","code":""},{"path":"/reference/BinRW.html","id":"patient-dependent-parameters-","dir":"Reference","previous_headings":"","what":"Patient-dependent parameters:","title":"Binomial random walk model — BinRW","text":"logit_y0: Logit initial condition","code":""},{"path":"/reference/BinRW.html","id":"observation-dependent-patient-and-time-dependent-parameters-","dir":"Reference","previous_headings":"","what":"Observation-dependent (patient- and time-dependent) parameters:","title":"Binomial random walk model — BinRW","text":"y_lat: Latent score (probability) logit_lat: logit y_lat See list_parameters(model = \"BinRW\") details.","code":""},{"path":"/reference/BinRW.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Binomial random walk model — BinRW","text":"priors passed named list elements sigma, mu_logit_y0 sigma_logit_y0 specifying priors corresponding parameters. element list vector length 2, containing values x1 x2, x2 > 0, : sigma ~ normal+(x1, x2). mu_logit_y0 ~ normal(x1, x2) sigma_logit_y0 ~ normal+(x1, x2) NB: sigma sigma_logit_y0, usually x1=0 define half-normal distribution since parameters constrained positive.","code":""},{"path":"/reference/BinRW.html","id":"default-priors","dir":"Reference","previous_headings":"","what":"Default priors","title":"Binomial random walk model — BinRW","text":"default priors depend max_score, printed examples section. default prior sigma translates odd ratio increment 5 (~ 2 * upper bound prior). default priors mu_logit_y0 sigma_logit_y0 translates approximately uniform prior y0.","code":""},{"path":"/reference/BinRW.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Binomial random walk model — BinRW","text":"","code":"EczemaModel(\"BinRW\", max_score = 100) #> BinRW model (discrete) #> max_score = 100  #> Prior:  #> - sigma ~ normal+(0,0.4) #> - mu_logit_y0 ~ normal(0,1) #> - sigma_logit_y0 ~ normal(0,1.5)"},{"path":"/reference/EczemaFit.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit an EczemaModel — EczemaFit","title":"Fit an EczemaModel — EczemaFit","text":"Fit EczemaModel","code":""},{"path":"/reference/EczemaFit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit an EczemaModel — EczemaFit","text":"","code":"EczemaFit(model, train, test, ...)  # S3 method for EczemaModel EczemaFit(model, train, test = NULL, ...)"},{"path":"/reference/EczemaFit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit an EczemaModel — EczemaFit","text":"model Object train Training dataframe (see details ) test Testing dataframe (see details ) ... Arguments pass rstan::sampling()","code":""},{"path":"/reference/EczemaFit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit an EczemaModel — EczemaFit","text":"Stanfit object","code":""},{"path":[]},{"path":"/reference/EczemaFit.html","id":"all-models-except-mc-","dir":"Reference","previous_headings":"","what":"All models except \"MC\"","title":"Fit an EczemaModel — EczemaFit","text":"train test columns Patient (patient ID), Time (timepoint) Score (score model). Patient take integer values 1 number patients training set. Time take integer (discrete) values starts one every patient. Score take values 0 max_score. Missing values allowed (Time values necessarily consecutive, example Score t=5 missing, t=4 t=6, just remove t=5).","code":""},{"path":"/reference/EczemaFit.html","id":"-mc-model","dir":"Reference","previous_headings":"","what":"\"MC\" model","title":"Fit an EczemaModel — EczemaFit","text":"train test columns y0 (current state), y1 (next state) dt (time delay states). y0 y1 take integer values 1 K. dt take integer values greater equal 1. Missing values allowed.","code":""},{"path":"/reference/EczemaFit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fit an EczemaModel — EczemaFit","text":"","code":"if (FALSE) { model <- EczemaModel(\"BinRW\", max_score = 100) train <- data.frame(Patient = 1, Time = 1:10, Score = rbinom(10, 100, .5)) EczemaFit(model, train) }"},{"path":"/reference/EczemaModel.html","id":null,"dir":"Reference","previous_headings":"","what":"EczemaModel constructor — EczemaModel","title":"EczemaModel constructor — EczemaModel","text":"EczemaModel constructor","code":""},{"path":"/reference/EczemaModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"EczemaModel constructor — EczemaModel","text":"","code":"EczemaModel(   model_name = c(\"BinRW\", \"OrderedRW\", \"BinMC\", \"RW\", \"Smoothing\", \"AR1\", \"MixedAR1\",     \"MC\"),   max_score = NULL,   K = NULL,   discrete = FALSE,   prior = NULL )"},{"path":"/reference/EczemaModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"EczemaModel constructor — EczemaModel","text":"model_name Name model create max_score Maximum value score can take. Required models except \"MC\". K Number categories. required \"MC\" model. discrete Whether model discrete . required \"RW\". prior Named list model's priors. uses default priors (see default_prior()) NULL parameters provided.","code":""},{"path":"/reference/EczemaModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"EczemaModel constructor — EczemaModel","text":"object (list) class model_name EczemaModel, elements: model_name: Name model stanmodel: Name Stan model. Used internally locate compiled code. can also used store Stan code filepath. discrete: Whether model discrete . max_score: Maximum value score can take (applicable) K: Number categories (applicable) prior: List parameters' priors","code":""},{"path":"/reference/EczemaModel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"EczemaModel constructor — EczemaModel","text":"","code":"EczemaModel(\"BinRW\", max_score = 10) #> BinRW model (discrete) #> max_score = 10  #> Prior:  #> - sigma ~ normal+(0,0.4) #> - mu_logit_y0 ~ normal(0,1) #> - sigma_logit_y0 ~ normal(0,1.5)"},{"path":"/reference/EczemaPred-package.html","id":null,"dir":"Reference","previous_headings":"","what":"The 'EczemaPred' package. — EczemaPred-package","title":"The 'EczemaPred' package. — EczemaPred-package","text":"collection models serve building blocks predicting eczema severity.","code":""},{"path":"/reference/EczemaPred-package.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"The 'EczemaPred' package. — EczemaPred-package","text":"Stan Development Team (2020). RStan: R interface Stan. R package version 2.21.2.","code":""},{"path":"/reference/MC.html","id":null,"dir":"Reference","previous_headings":"","what":"Markov Chain model — MC","title":"Markov Chain model — MC","text":"details see Markov Chain vignette.","code":""},{"path":"/reference/MC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Markov Chain model — MC","text":"K Number states Markov Chain prior Named list model's priors. NULL, uses default prior model (see default_prior()).","code":""},{"path":"/reference/MC.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Markov Chain model — MC","text":"Details model available paper.","code":""},{"path":"/reference/MC.html","id":"parameters","dir":"Reference","previous_headings":"","what":"Parameters","title":"Markov Chain model — MC","text":"p: matrix size K * K p[, j] represents transition probabilities state state j. See list_parameters(model = \"MC\") details.","code":""},{"path":"/reference/MC.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Markov Chain model — MC","text":"priors passed named list element p. transition probabilities state p[, ] assumed follow Dirichlet distribution. prior matrix line correspond parameters Dirichlet distribution p[, ].","code":""},{"path":"/reference/MC.html","id":"default-priors","dir":"Reference","previous_headings":"","what":"Default priors","title":"Markov Chain model — MC","text":"default prior p[, ] symmetric uniform Dirichlet distribution (concentration parameters equal 1).","code":""},{"path":"/reference/MC.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Markov Chain model — MC","text":"","code":"EczemaModel(\"MC\", K = 5) #> MC model (discrete) #> 5 categories  #> Prior:  #> - p[1, ] ~ dirichlet(1,1,1,1,1) #> - p[2, ] ~ dirichlet(1,1,1,1,1) #> - p[3, ] ~ dirichlet(1,1,1,1,1) #> - p[4, ] ~ dirichlet(1,1,1,1,1) #> - p[5, ] ~ dirichlet(1,1,1,1,1)"},{"path":"/reference/MixedAR1.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixed effect autoregressive model (order 1) — MixedAR1","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"Mixed effect autoregressive model (order 1)","code":""},{"path":"/reference/MixedAR1.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"max_score Maximum value score can take. Note even discrete=FALSE, max_score must integer. discrete Whether use discrete normal distribution. used check whether data discrete , rounding predictions (cf. testing). prior Named list model's priors. NULL, uses default prior model (see default_prior()).","code":""},{"path":"/reference/MixedAR1.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"Details model available paper. model takes input continuous score defined 0 max_score. model naive likelihood non-truncated discretised (discrete = TRUE). Unlike AR1 model, discretisation predictions implemented details see vignette.","code":""},{"path":[]},{"path":"/reference/MixedAR1.html","id":"population-parameters-","dir":"Reference","previous_headings":"","what":"Population parameters:","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"sigma: Standard deviation autoregression mu_logit_slope: Population mean logit slope sigma_logit_slope: Population standard deviation logit slope mu_inf: Population mean y_inf sigma_inf: Population standard deviation y_inf","code":""},{"path":"/reference/MixedAR1.html","id":"patient-dependent-parameters-","dir":"Reference","previous_headings":"","what":"Patient-dependent parameters:","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"slope: Autocorrelation parameter y_inf: Autoregression mean intercept: Intercept","code":""},{"path":"/reference/MixedAR1.html","id":"other-parameters-","dir":"Reference","previous_headings":"","what":"Other parameters:","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"y_mis: Missing values See list_parameters(model = \"MixedAR1\") details.","code":""},{"path":"/reference/MixedAR1.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"priors passed named list elements sigma, mu_logit_slope, sigma_logit_slope, mu_inf, sigma_inf specifying priors corresponding parameters. element list vector length 2, containing values x1 x2, x2 > 0, : sigma / max_score ~ normal+(x1, x2). mu_logit_slope ~ normal(x1, x2). sigma_logit_slope ~ normal+(x1, x2). mu_inf / max_score ~ normal(x1, x2). sigma_inf / max_score ~ normal+(x1, x2). NB: sigma, sigma_logit_slope sigma_inf, usually x1=0 define half-normal distribution since parameter constrained positive.","code":""},{"path":"/reference/MixedAR1.html","id":"default-priors","dir":"Reference","previous_headings":"","what":"Default priors","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"default prior sigma translates width predictive distribution max_score. default priors mu_logit_slope sigma_logit_slope \"reasonable\" ranges translate prior slope approximately uniform. default prior mu_inf spans entire range score. default prior sigma_inf translates range distribution y_inf max_score.","code":""},{"path":"/reference/MixedAR1.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mixed effect autoregressive model (order 1) — MixedAR1","text":"","code":"EczemaModel(\"MixedAR1\", max_score = 100) #> MixedAR1 model (continuous) #> max_score = 100  #> Prior:  #> - sigma / max_score ~ normal+(0,0.1) #> - mu_logit_slope ~ normal(0,1) #> - sigma_logit_slope ~ normal+(0,1.5) #> - mu_inf / max_score ~ normal(0.5,0.25) #> - sigma_inf / max_score ~ normal+(0.5,0.25)"},{"path":"/reference/OrderedRW.html","id":null,"dir":"Reference","previous_headings":"","what":"Ordered Logistic random walk model — OrderedRW","title":"Ordered Logistic random walk model — OrderedRW","text":"state-space model defined Ordered logistic measurement error distribution latent random walk. details see BinRW vignette.","code":""},{"path":"/reference/OrderedRW.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ordered Logistic random walk model — OrderedRW","text":"max_score Maximum value score can take prior Named list model's priors. NULL, uses default prior model (see default_prior()).","code":""},{"path":"/reference/OrderedRW.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Ordered Logistic random walk model — OrderedRW","text":"Details model available paper.","code":""},{"path":[]},{"path":"/reference/OrderedRW.html","id":"population-parameters-","dir":"Reference","previous_headings":"","what":"Population parameters:","title":"Ordered Logistic random walk model — OrderedRW","text":"sigma_lat: Standard deviation random walk sigma_meas: Standard deviation (scale) logistic distribution ([0, max_score] space) sigma_tot: Total standard deviation prediction one step ahead rho2: Proportion measurement variance total variance. can interpreted similarly R-squared, proportion explained variance (variance measurements) total variance. mu_y0: Population mean y0 (initial condition). sigma_y0: Population standard deviation y0 (initial condition). delta: Relative difference cutpoints (simplex length max_score - 1) ct: Cutpoints (vector length max_score, [0, max_score] space)","code":""},{"path":"/reference/OrderedRW.html","id":"patient-dependent-parameters-","dir":"Reference","previous_headings":"","what":"Patient-dependent parameters:","title":"Ordered Logistic random walk model — OrderedRW","text":"y0: initial latent score (y_lat t0).","code":""},{"path":"/reference/OrderedRW.html","id":"observation-dependent-patient-and-time-dependent-parameters-","dir":"Reference","previous_headings":"","what":"Observation-dependent (patient- and time-dependent) parameters:","title":"Ordered Logistic random walk model — OrderedRW","text":"y_lat: Latent score ([0, max_score] space) See list_parameters(model = \"OrderedRW\") details.","code":""},{"path":"/reference/OrderedRW.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Ordered Logistic random walk model — OrderedRW","text":"priors passed named list elements delta, sigma_lat, sigma_meas, mu_y0 sigma_y0 specifying priors corresponding parameters. element delta vector X1 length max_score - 1, elements X1 positive delta ~ dirichlet(X1). latent score can interpreted original [0, max_score] space, priors parameters specified normalised max_score. priors defined vector length 2, containing values x1 x2, x2 > 0, : sigma_meas / max_score ~ lognormal(x1, x2) sigma_lat / max_score ~ lognormal(x1, x2) mu_y0 ~ normal(x1, x2) sigma_y0 ~ normal+(x1, x2) NB: lognormal distribution, x1 corresponds mean log x2 sd log. NB: sigma_y0 constrained positive x1 usually set 0 define half-normal distribution.","code":""},{"path":"/reference/OrderedRW.html","id":"default-priors","dir":"Reference","previous_headings":"","what":"Default priors","title":"Ordered Logistic random walk model — OrderedRW","text":"default prior delta uniform symmetric Dirichlet distribution concentration 2. default priors sigma_meas sigma_lat lognormal distribution translate 95% CI approximately [.02, 0.40] * M. prior sigma_lat thus allows fast slow transitions state y = 0 likely outcome state y = M likely outcome. prior sigma_meas allows precise imprecise measurements. default priors mu_y0 sigma_y0 reasonable ranges translate approximately uniform prior range score y0.","code":""},{"path":"/reference/OrderedRW.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ordered Logistic random walk model — OrderedRW","text":"","code":"EczemaModel(\"OrderedRW\", max_score = 10) #> OrderedRW model (discrete) #> max_score = 10  #> Prior:  #> - delta ~ dirichlet(2,2,2,2,2,2,2,2,2) #> - sigma_meas / max_score ~ lognormal(-2.3,0.69) #> - sigma_lat / max_score ~ lognormal(-2.3,0.69) #> - mu_y0 / max_score ~ normal(0.5,0.25) #> - sigma_y0 / max_score ~ normal+(0,0.12)"},{"path":"/reference/RW.html","id":null,"dir":"Reference","previous_headings":"","what":"Random walk model — RW","title":"Random walk model — RW","text":"Random walk model","code":""},{"path":"/reference/RW.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Random walk model — RW","text":"max_score Maximum value score can take discrete Whether use discrete normal distribution. used check whether data discrete , rounding predictions (cf. testing). prior Named list model's priors. NULL, uses default prior model (see default_prior()).","code":""},{"path":"/reference/RW.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Random walk model — RW","text":"Details model available paper. model takes input continuous score defined 0 max_score. model naive likelihood non-truncated discretised (discrete = TRUE). result, sampling prior predictive distribution can challenging score near bounds variance sufficiently large. details see vignette.","code":""},{"path":"/reference/RW.html","id":"parameters","dir":"Reference","previous_headings":"","what":"Parameters","title":"Random walk model — RW","text":"sigma: Standard deviation random walk y_mis: Missing values See list_parameters(model = \"RW\") details.","code":""},{"path":"/reference/RW.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Random walk model — RW","text":"priors passed named list element sigma specifying priors corresponding parameter, sigma / max_score ~ normal+(x1, x2) element sigma list vector length two containing x1 x2. NB: usually x1=0 define half-normal distribution (sigma constraint positive) x2 positive.","code":""},{"path":"/reference/RW.html","id":"default-priors","dir":"Reference","previous_headings":"","what":"Default priors","title":"Random walk model — RW","text":"default prior sigma translates width predictive distribution max_score.","code":""},{"path":"/reference/RW.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Random walk model — RW","text":"","code":"EczemaModel(\"RW\", max_score = 100, discrete = FALSE) #> RW model (continuous) #> max_score = 100  #> Prior:  #> - sigma / max_score ~ normal+(0,0.1)"},{"path":"/reference/Smoothing.html","id":null,"dir":"Reference","previous_headings":"","what":"Exponential smoothing model — Smoothing","title":"Exponential smoothing model — Smoothing","text":"Exponential smoothing model","code":""},{"path":"/reference/Smoothing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Exponential smoothing model — Smoothing","text":"max_score Maximum value score can take discrete Whether use discrete normal distribution. used check whether data discrete , rounding predictions (cf. testing). prior Named list model's priors. NULL, uses default prior model (see default_prior()).","code":""},{"path":"/reference/Smoothing.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Exponential smoothing model — Smoothing","text":"Details model available paper. model takes input continuous score defined 0 max_score. model naive likelihood non-truncated discretised (discrete = TRUE). result, sampling prior predictive distribution can challenging score near bounds variance sufficiently large. details see vignette.","code":""},{"path":"/reference/Smoothing.html","id":"parameters","dir":"Reference","previous_headings":"","what":"Parameters","title":"Exponential smoothing model — Smoothing","text":"sigma: Standard deviation random walk alpha: Smoothing factor tau: Time constant associated smoothing factor y_mis: Missing values See list_parameters(model = \"Smoothing\") details.","code":""},{"path":"/reference/Smoothing.html","id":"priors","dir":"Reference","previous_headings":"","what":"Priors","title":"Exponential smoothing model — Smoothing","text":"priors passed named list elements sigma tau specifying priors corresponding parameters. element list vector length 2, containing values x1 x2, x2 > 0, : sigma / max_score ~ normal+(x1, x2). tau ~ lognormal(x1, x2). NB: sigma, usually x1=0 define half-normal distribution since parameter constrained positive.","code":""},{"path":"/reference/Smoothing.html","id":"default-priors","dir":"Reference","previous_headings":"","what":"Default priors","title":"Exponential smoothing model — Smoothing","text":"default prior sigma translates width predictive distribution max_score. default prior tau assumes range less 1 100 (time units).","code":""},{"path":"/reference/Smoothing.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Exponential smoothing model — Smoothing","text":"","code":"EczemaModel(\"Smoothing\", max_score = 100) #> Smoothing model (continuous) #> max_score = 100  #> Prior:  #> - sigma / max_score ~ normal+(0,0.1) #> - tau ~ lognormal(1.2,1.7)"},{"path":"/reference/add_broken_pointline.html","id":null,"dir":"Reference","previous_headings":"","what":"Add broken pointline to ggplot — add_broken_pointline","title":"Add broken pointline to ggplot — add_broken_pointline","text":"Add broken pointline ggplot","code":""},{"path":"/reference/add_broken_pointline.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add broken pointline to ggplot — add_broken_pointline","text":"","code":"add_broken_pointline(df, aes_x = \"x\", aes_y = \"y\", size = 1, ...)"},{"path":"/reference/add_broken_pointline.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add broken pointline to ggplot — add_broken_pointline","text":"df Data columns aes_x aes_y. aes_x Name x aesthetic. aes_y Name y aesthetic. size Size line points. ... aesthetics pass ggplot2::aes_(). Valid aesthetics aesthetics ggplot2::geom_path() ggplot2::geom_point() (except size fixed). NB: want colour change Group need add colour = .name(Group).","code":""},{"path":"/reference/add_broken_pointline.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add broken pointline to ggplot — add_broken_pointline","text":"List add ggplot.","code":""},{"path":"/reference/add_broken_pointline.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add broken pointline to ggplot — add_broken_pointline","text":"","code":"library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union library(ggplot2)  df1 <- tibble(x = 1:100, y = cumsum(rnorm(100))) %>%   slice_sample(prop = .8) %>%   arrange(x)  ggplot() +   add_broken_pointline(df1) +   theme_bw(base_size = 15) #> Warning: Removed 20 rows containing missing values (geom_point).   df2 <- mutate(df1, Group = case_when(x < 60 ~ \"A\", TRUE ~ \"B\"))  ggplot() +   add_broken_pointline(df2, colour = as.name(\"Group\")) +   scale_colour_discrete(na.translate = FALSE) +   theme_bw(base_size = 15) #> Warning: Removed 20 row(s) containing missing values (geom_path). #> Warning: Removed 20 rows containing missing values (geom_point)."},{"path":"/reference/add_fanchart.html","id":null,"dir":"Reference","previous_headings":"","what":"Add fanchart to ggplot — add_fanchart","title":"Add fanchart to ggplot — add_fanchart","text":"fanchart obtained overlaying ggplot2::geom_ribbon() different widths (corresponding different levels). function geom.","code":""},{"path":"/reference/add_fanchart.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add fanchart to ggplot — add_fanchart","text":"","code":"add_fanchart(   df,   aes_x = \"Time\",   aes_ymin = \"Lower\",   aes_ymax = \"Upper\",   aes_fill = \"Level\",   legend_fill = c(\"continuous\", \"discrete\"),   labs_fill = ifelse(legend_fill == \"continuous\", \"Confidence level\", \"Probability\"),   palette = c(\"#EFF3FF\", \"#C6DBEF\", \"#9ECAE1\", \"#6BAED6\", \"#3182BD\", \"#08519C\") )"},{"path":"/reference/add_fanchart.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add fanchart to ggplot — add_fanchart","text":"df Data columns aes_x, aes_ymin, aes_ymax aes_fill aes_x Name x aesthetic aes_ymin Name ymin aesthetic aes_ymax Name ymax aesthetic aes_fill Name fill aesthetic legend_fill Whether legend displayed continuous discrete categories labs_fill Name give legend palette Colour palette use. default single-hue blue palette RColorBrewer::brewer.pal(n = 6, \"Blues\").","code":""},{"path":"/reference/add_fanchart.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add fanchart to ggplot — add_fanchart","text":"List added ggplot","code":""},{"path":"/reference/add_fanchart.html","id":"alternative","dir":"Reference","previous_headings":"","what":"Alternative","title":"Add fanchart to ggplot — add_fanchart","text":"similar result can obtained using ggdist::geom_lineribbon(), difference ggdist function also plots point estimate (proper geom). avoid plotting point estimate, size can set 0 y = .lower example.","code":""},{"path":"/reference/add_fanchart.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Add fanchart to ggplot — add_fanchart","text":"","code":"library(dplyr) library(tidyr) library(ggplot2)  tmp <- tibble(Time = 0:10,               y = Time^1.5) %>%   expand_grid(Level = seq(0.1, 0.9, 0.2)) %>%   mutate(Width = qnorm(0.5 + Level / 2, sd = 2),          Lower = y - Width,          Upper = y + Width) ggplot() + add_fanchart(tmp)"},{"path":"/reference/add_historical_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"Performance of (population) historical forecast — add_historical_pred","title":"Performance of (population) historical forecast — add_historical_pred","text":"Performance (population) historical forecast","code":""},{"path":"/reference/add_historical_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performance of (population) historical forecast — add_historical_pred","text":"","code":"add_historical_pred(   test,   train,   max_score,   discrete = TRUE,   add_uniform = TRUE,   include_samples = FALSE,   n_samples = NULL )"},{"path":"/reference/add_historical_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performance of (population) historical forecast — add_historical_pred","text":"test Testing dataframe. requirements contains column \"Score\". train Training dataframe. requirements contains column \"Score\". max_score Maximum value score can take discrete Whether estimate discrete continuous historical forecast add_uniform Whether include samples uniform distribution computing discrete historical forecast. ensures states visited. include_samples Whether return samples historical forecast output n_samples include_samples=TRUE, many samples return. NULL, function return training set.","code":""},{"path":"/reference/add_historical_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Performance of (population) historical forecast — add_historical_pred","text":"Dataframe test appended columns \"lpd\", \"RPS\" (CRPS discrete=FALSE) optionally \"Samples\"","code":""},{"path":"/reference/add_historical_pred.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Performance of (population) historical forecast — add_historical_pred","text":"continuous historical forecast calculated considering training set samples predictive distribution.","code":""},{"path":"/reference/add_historical_pred.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Performance of (population) historical forecast — add_historical_pred","text":"","code":"max_score <- 100 train <- data.frame(Score = rbinom(1e2, max_score, 0.2)) test <- data.frame(Score = rbinom(1e2, max_score, 0.5)) add_historical_pred(test, train, max_score) #>     Score       lpd        RPS #> 1      59 -5.303305 0.19393183 #> 2      46 -5.303305 0.12602139 #> 3      52 -5.303305 0.15527512 #> 4      55 -5.303305 0.17124527 #> 5      60 -5.303305 0.19985223 #> 6      46 -5.303305 0.12602139 #> 7      57 -5.303305 0.18238954 #> 8      53 -5.303305 0.16049900 #> 9      51 -5.303305 0.15015074 #> 10     51 -5.303305 0.15015074 #> 11     46 -5.303305 0.12602139 #> 12     55 -5.303305 0.17124527 #> 13     57 -5.303305 0.18238954 #> 14     53 -5.303305 0.16049900 #> 15     46 -5.303305 0.12602139 #> 16     48 -5.303305 0.13537462 #> 17     48 -5.303305 0.13537462 #> 18     51 -5.303305 0.15015074 #> 19     53 -5.303305 0.16049900 #> 20     45 -5.303305 0.12149402 #> 21     58 -5.303305 0.18811094 #> 22     56 -5.303305 0.17676765 #> 23     49 -5.303305 0.14020049 #> 24     48 -5.303305 0.13537462 #> 25     54 -5.303305 0.16582238 #> 26     39 -5.303305 0.09641940 #> 27     46 -5.303305 0.12602139 #> 28     57 -5.303305 0.18238954 #> 29     50 -5.303305 0.14512586 #> 30     55 -5.303305 0.17124527 #> 31     54 -5.303305 0.16582238 #> 32     47 -5.303305 0.13064825 #> 33     50 -5.303305 0.14512586 #> 34     55 -5.303305 0.17124527 #> 35     52 -5.303305 0.15527512 #> 36     57 -5.303305 0.18238954 #> 37     51 -5.303305 0.15015074 #> 38     52 -5.303305 0.15527512 #> 39     53 -5.303305 0.16049900 #> 40     51 -5.303305 0.15015074 #> 41     49 -5.303305 0.14020049 #> 42     57 -5.303305 0.18238954 #> 43     48 -5.303305 0.13537462 #> 44     55 -5.303305 0.17124527 #> 45     37 -5.303305 0.08885721 #> 46     43 -5.303305 0.11273780 #> 47     41 -5.303305 0.10437959 #> 48     50 -5.303305 0.14512586 #> 49     44 -5.303305 0.11706616 #> 50     49 -5.303305 0.14020049 #> 51     48 -5.303305 0.13537462 #> 52     49 -5.303305 0.14020049 #> 53     49 -5.303305 0.14020049 #> 54     51 -5.303305 0.15015074 #> 55     50 -5.303305 0.14512586 #> 56     55 -5.303305 0.17124527 #> 57     47 -5.303305 0.13064825 #> 58     49 -5.303305 0.14020049 #> 59     44 -5.303305 0.11706616 #> 60     64 -5.303305 0.22452885 #> 61     43 -5.303305 0.11273780 #> 62     52 -5.303305 0.15527512 #> 63     42 -5.303305 0.10850895 #> 64     54 -5.303305 0.16582238 #> 65     49 -5.303305 0.14020049 #> 66     45 -5.303305 0.12149402 #> 67     50 -5.303305 0.14512586 #> 68     55 -5.303305 0.17124527 #> 69     51 -5.303305 0.15015074 #> 70     53 -5.303305 0.16049900 #> 71     50 -5.303305 0.14512586 #> 72     46 -5.303305 0.12602139 #> 73     47 -5.303305 0.13064825 #> 74     51 -5.303305 0.15015074 #> 75     46 -5.303305 0.12602139 #> 76     44 -5.303305 0.11706616 #> 77     53 -5.303305 0.16049900 #> 78     43 -5.303305 0.11273780 #> 79     50 -5.303305 0.14512586 #> 80     43 -5.303305 0.11273780 #> 81     46 -5.303305 0.12602139 #> 82     58 -5.303305 0.18811094 #> 83     48 -5.303305 0.13537462 #> 84     56 -5.303305 0.17676765 #> 85     49 -5.303305 0.14020049 #> 86     44 -5.303305 0.11706616 #> 87     45 -5.303305 0.12149402 #> 88     53 -5.303305 0.16049900 #> 89     50 -5.303305 0.14512586 #> 90     50 -5.303305 0.14512586 #> 91     45 -5.303305 0.12149402 #> 92     46 -5.303305 0.12602139 #> 93     52 -5.303305 0.15527512 #> 94     47 -5.303305 0.13064825 #> 95     41 -5.303305 0.10437959 #> 96     46 -5.303305 0.12602139 #> 97     56 -5.303305 0.17676765 #> 98     53 -5.303305 0.16049900 #> 99     55 -5.303305 0.17124527 #> 100    51 -5.303305 0.15015074"},{"path":"/reference/add_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Append lpd and (C)RPS to (test) dataframe — add_metrics","title":"Append lpd and (C)RPS to (test) dataframe — add_metrics","text":"add_metrics1_d() add_metrics1_c() extracts lpd RPS Stanfit object add_metrics2_d() add_metrics2_c() calculates lpd (C)RPS empirical pmf metrics add_metrics2_c() CRPS add_metrics1_c() calculated using scoringRules package.","code":""},{"path":"/reference/add_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Append lpd and (C)RPS to (test) dataframe — add_metrics","text":"","code":"add_metrics1_d(df, fit)  add_metrics1_c(df, fit)  add_metrics2_d(df, support, add_samples = support)  add_metrics2_c(df, add_samples = NULL, bw = NULL)"},{"path":"/reference/add_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Append lpd and (C)RPS to (test) dataframe — add_metrics","text":"df Dataframe add metrics add_metrics1_c(), must contain column \"Score\". add_metrics2_c() add_metrics2_d(), must contain columns \"Samples\" \"Score\". fit Stanfit object parameters \"lpd\", add_metrics1_d() \"cum_err\". support Support distribution add_samples Numeric vector used initialise distribution computing lpd (C)RPS. example, can used add uniform distribution vector samples, avoid problems tail distribution. NULL, empirical pmf changed. Default uniform distribution (.e. support) add_metrics2_d() NULL add_metrics2_c(). column \"Samples\" modified add_samples NULL. bw Bandwidth, calculating lpd, see scoringRules::logs_sample(). Useful set \"resolution\" distribution.","code":""},{"path":"/reference/add_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Append lpd and (C)RPS to (test) dataframe — add_metrics","text":"Dataframe df appended columns \"lpd\", \"RPS\" (\"CRPS\" add_metrics1_c() add_metrics2_d()).","code":""},{"path":[]},{"path":"/reference/add_predictions.html","id":null,"dir":"Reference","previous_headings":"","what":"Append lpd, (C)RPS and predictive samples to (test) dataframe — add_predictions","title":"Append lpd, (C)RPS and predictive samples to (test) dataframe — add_predictions","text":"Append lpd, (C)RPS predictive samples (test) dataframe","code":""},{"path":"/reference/add_predictions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Append lpd, (C)RPS and predictive samples to (test) dataframe — add_predictions","text":"","code":"add_predictions(   df,   fit,   discrete = TRUE,   include_samples = FALSE,   n_samples = NULL )"},{"path":"/reference/add_predictions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Append lpd, (C)RPS and predictive samples to (test) dataframe — add_predictions","text":"df Dataframe. discrete = FALSE, must contain column \"Score\". fit Stanfit object discrete Whether estimate discrete continuous forecast. discrete forecast, RPS computed CRPS continuous forecast. include_samples Whether return samples historical forecast output n_samples include_samples=TRUE, many samples return. Default (=NULL) samples.","code":""},{"path":"/reference/add_predictions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Append lpd, (C)RPS and predictive samples to (test) dataframe — add_predictions","text":"Dataframe df appended columns \"lpd\", \"RPS\" (CRPS discrete=FALSE) optionally \"Samples\"","code":""},{"path":[]},{"path":"/reference/add_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Add prior to the list serving as input to the Stan sampler — add_prior","title":"Add prior to the list serving as input to the Stan sampler — add_prior","text":"Used internally","code":""},{"path":"/reference/add_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add prior to the list serving as input to the Stan sampler — add_prior","text":"","code":"add_prior(data_stan, prior, prefix = \"prior_\")"},{"path":"/reference/add_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add prior to the list serving as input to the Stan sampler — add_prior","text":"data_stan List prior named list corresponding parameters' prior prefix Prefix add names prior","code":""},{"path":"/reference/add_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add prior to the list serving as input to the Stan sampler — add_prior","text":"data_stan additional items corresponding prior.","code":""},{"path":"/reference/add_uniform_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"Performance of a uniform forecast — add_uniform_pred","title":"Performance of a uniform forecast — add_uniform_pred","text":"Performance uniform forecast","code":""},{"path":"/reference/add_uniform_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Performance of a uniform forecast — add_uniform_pred","text":"","code":"add_uniform_pred(   test,   max_score,   discrete = TRUE,   include_samples = FALSE,   n_samples = NULL )"},{"path":"/reference/add_uniform_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Performance of a uniform forecast — add_uniform_pred","text":"test Testing dataframe. requirements contains column \"Score\". max_score Maximum value score can take discrete Whether estimate discrete continuous historical forecast include_samples Whether return samples historical forecast output n_samples include_samples=TRUE, many samples return. NULL, samples 0:max_score returned.","code":""},{"path":"/reference/add_uniform_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Performance of a uniform forecast — add_uniform_pred","text":"Dataframe test appended columns \"lpd\", \"RPS\" (CRPS discrete=FALSE) optionally \"Samples\"","code":""},{"path":"/reference/add_uniform_pred.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Performance of a uniform forecast — add_uniform_pred","text":"","code":"max_score <- 100 test <- data.frame(Score = rbinom(1e2, max_score, 0.5)) add_uniform_pred(test, max_score) #>     Score       lpd        RPS #> 1      39 -4.615121 0.09613861 #> 2      50 -4.615121 0.08415842 #> 3      42 -4.615121 0.09049505 #> 4      46 -4.615121 0.08574257 #> 5      58 -4.615121 0.09049505 #> 6      51 -4.615121 0.08425743 #> 7      55 -4.615121 0.08663366 #> 8      48 -4.615121 0.08455446 #> 9      47 -4.615121 0.08504950 #> 10     51 -4.615121 0.08425743 #> 11     42 -4.615121 0.09049505 #> 12     47 -4.615121 0.08504950 #> 13     57 -4.615121 0.08900990 #> 14     46 -4.615121 0.08574257 #> 15     52 -4.615121 0.08455446 #> 16     54 -4.615121 0.08574257 #> 17     44 -4.615121 0.08772277 #> 18     39 -4.615121 0.09613861 #> 19     58 -4.615121 0.09049505 #> 20     51 -4.615121 0.08425743 #> 21     41 -4.615121 0.09217822 #> 22     58 -4.615121 0.09049505 #> 23     46 -4.615121 0.08574257 #> 24     51 -4.615121 0.08425743 #> 25     43 -4.615121 0.08900990 #> 26     54 -4.615121 0.08574257 #> 27     48 -4.615121 0.08455446 #> 28     51 -4.615121 0.08425743 #> 29     50 -4.615121 0.08415842 #> 30     56 -4.615121 0.08772277 #> 31     56 -4.615121 0.08772277 #> 32     44 -4.615121 0.08772277 #> 33     45 -4.615121 0.08663366 #> 34     47 -4.615121 0.08504950 #> 35     46 -4.615121 0.08574257 #> 36     43 -4.615121 0.08900990 #> 37     40 -4.615121 0.09405941 #> 38     48 -4.615121 0.08455446 #> 39     45 -4.615121 0.08663366 #> 40     43 -4.615121 0.08900990 #> 41     54 -4.615121 0.08574257 #> 42     47 -4.615121 0.08504950 #> 43     54 -4.615121 0.08574257 #> 44     60 -4.615121 0.09405941 #> 45     47 -4.615121 0.08504950 #> 46     52 -4.615121 0.08455446 #> 47     45 -4.615121 0.08663366 #> 48     52 -4.615121 0.08455446 #> 49     49 -4.615121 0.08425743 #> 50     56 -4.615121 0.08772277 #> 51     51 -4.615121 0.08425743 #> 52     48 -4.615121 0.08455446 #> 53     51 -4.615121 0.08425743 #> 54     42 -4.615121 0.09049505 #> 55     56 -4.615121 0.08772277 #> 56     50 -4.615121 0.08415842 #> 57     49 -4.615121 0.08425743 #> 58     52 -4.615121 0.08455446 #> 59     55 -4.615121 0.08663366 #> 60     49 -4.615121 0.08425743 #> 61     35 -4.615121 0.10643564 #> 62     61 -4.615121 0.09613861 #> 63     51 -4.615121 0.08425743 #> 64     56 -4.615121 0.08772277 #> 65     48 -4.615121 0.08455446 #> 66     47 -4.615121 0.08504950 #> 67     54 -4.615121 0.08574257 #> 68     54 -4.615121 0.08574257 #> 69     55 -4.615121 0.08663366 #> 70     53 -4.615121 0.08504950 #> 71     51 -4.615121 0.08425743 #> 72     48 -4.615121 0.08455446 #> 73     48 -4.615121 0.08455446 #> 74     47 -4.615121 0.08504950 #> 75     53 -4.615121 0.08504950 #> 76     51 -4.615121 0.08425743 #> 77     47 -4.615121 0.08504950 #> 78     50 -4.615121 0.08415842 #> 79     52 -4.615121 0.08455446 #> 80     58 -4.615121 0.09049505 #> 81     44 -4.615121 0.08772277 #> 82     53 -4.615121 0.08504950 #> 83     62 -4.615121 0.09841584 #> 84     50 -4.615121 0.08415842 #> 85     53 -4.615121 0.08504950 #> 86     47 -4.615121 0.08504950 #> 87     51 -4.615121 0.08425743 #> 88     51 -4.615121 0.08425743 #> 89     44 -4.615121 0.08772277 #> 90     51 -4.615121 0.08425743 #> 91     59 -4.615121 0.09217822 #> 92     57 -4.615121 0.08900990 #> 93     55 -4.615121 0.08663366 #> 94     49 -4.615121 0.08425743 #> 95     57 -4.615121 0.08900990 #> 96     46 -4.615121 0.08574257 #> 97     51 -4.615121 0.08425743 #> 98     54 -4.615121 0.08574257 #> 99     46 -4.615121 0.08574257 #> 100    56 -4.615121 0.08772277"},{"path":"/reference/default_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Default prior — default_prior","title":"Default prior — default_prior","text":"Default prior","code":""},{"path":"/reference/default_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Default prior — default_prior","text":"","code":"default_prior(model, ...)  # S3 method for character default_prior(model, max_score = 2, K = 2, ...)"},{"path":"/reference/default_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Default prior — default_prior","text":"model Object ... Arguments pass methods max_score Maximum value score can take K Number categories","code":""},{"path":"/reference/default_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Default prior — default_prior","text":"Named list parameters' priors. details, see generic model class.","code":""},{"path":"/reference/default_prior.html","id":"methods-by-class-","dir":"Reference","previous_headings":"","what":"Methods (by class)","title":"Default prior — default_prior","text":"character: function creates EczemaModel object call corresponding method.","code":""},{"path":"/reference/default_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Default prior — default_prior","text":"","code":"default_prior(EczemaModel(\"BinRW\", max_score = 10)) #> $sigma #> [1] 0.0000000 0.4023595 #>  #> $mu_logit_y0 #> [1] 0 1 #>  #> $sigma_logit_y0 #> [1] 0.0 1.5 #>  default_prior(EczemaModel(\"MC\", K = 10)) #> $p #>       [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10] #>  [1,]    1    1    1    1    1    1    1    1    1     1 #>  [2,]    1    1    1    1    1    1    1    1    1     1 #>  [3,]    1    1    1    1    1    1    1    1    1     1 #>  [4,]    1    1    1    1    1    1    1    1    1     1 #>  [5,]    1    1    1    1    1    1    1    1    1     1 #>  [6,]    1    1    1    1    1    1    1    1    1     1 #>  [7,]    1    1    1    1    1    1    1    1    1     1 #>  [8,]    1    1    1    1    1    1    1    1    1     1 #>  [9,]    1    1    1    1    1    1    1    1    1     1 #> [10,]    1    1    1    1    1    1    1    1    1     1 #>  default_prior(\"BinRW\") #> default prior for max_score=2 (or, when applicable K=2) #> $sigma #> [1] 0.0000000 0.4023595 #>  #> $mu_logit_y0 #> [1] 0 1 #>  #> $sigma_logit_y0 #> [1] 0.0 1.5 #>"},{"path":"/reference/extract_metric.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract lpd (predictive log-likelihood) and RPS from stanfit object — extract_metric","title":"Extract lpd (predictive log-likelihood) and RPS from stanfit object — extract_metric","text":"metrics computed expected forecast distribution. lpd defined continuous discrete outcomes. RPS defined discrete outcomes computed extracting cumulative error distribution (cum_err: cumulative forecast - cumulative distribution), taking expected value (cf. expected forecast), squaring apply, summing possible outcomes normalising number outcomes - 1.","code":""},{"path":"/reference/extract_metric.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract lpd (predictive log-likelihood) and RPS from stanfit object — extract_metric","text":"","code":"extract_loglikelihood(fit, par_name = \"log_lik\")  extract_lpd(fit)  extract_RPS(fit, par_name = \"cum_err\")"},{"path":"/reference/extract_metric.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract lpd (predictive log-likelihood) and RPS from stanfit object — extract_metric","text":"fit Stanfit object par_name Name parameter parameter Stan model. Usually lpd, log_lik (log likelihood data) cum_err.","code":""},{"path":"/reference/extract_metric.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract lpd (predictive log-likelihood) and RPS from stanfit object — extract_metric","text":"Vector lpd/RPS prediction","code":""},{"path":"/reference/extract_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract parameters posterior summary statistics — extract_parameters","title":"Extract parameters posterior summary statistics — extract_parameters","text":"Extract parameters posterior summary statistics","code":""},{"path":"/reference/extract_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract parameters posterior summary statistics — extract_parameters","text":"","code":"extract_parameters(fit, pars = NULL, id = NULL, ...)"},{"path":"/reference/extract_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract parameters posterior summary statistics — extract_parameters","text":"fit Stanfit object pars Named list parameters extract. See list_parameters(). NULL, extracts parameters model. id Dataframe associating Index (Patient, Time) pairs. See get_index(). id used pars = NULL pars contain element PatientTime. ... Arguments pass HuraultMisc::summary_statistics().","code":""},{"path":"/reference/extract_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract parameters posterior summary statistics — extract_parameters","text":"Tibble dataframe containing posterior summary statistics. See details HuraultMisc::summary_statistics(). Additional columns Patient Time id NULL.","code":""},{"path":"/reference/extract_parameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract parameters posterior summary statistics — extract_parameters","text":"","code":"if (FALSE) { model <- EczemaModel(\"BinRW\", max_score = 100) id <- get_index2(rpois(10, 20)) train <- id %>% mutate(Score = rbinom(nrow(.), 100, .5)) fit <- EczemaFit(model, train) extract_parameters(fit, pars = list_parameters(\"BinRW\"), id = id) }"},{"path":"/reference/extract_simulations.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract simulations — extract_simulations","title":"Extract simulations — extract_simulations","text":"Extract simulations","code":""},{"path":"/reference/extract_simulations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract simulations — extract_simulations","text":"","code":"extract_simulations(fit, id, draw, pars = NULL)"},{"path":"/reference/extract_simulations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract simulations — extract_simulations","text":"fit Stanfit object id Dataframe linking index Stan model (Patient, Time) pairs, cf. output get_index() draw Draw ID pars Vector parameters extract. Default parameters except y_rep.","code":""},{"path":"/reference/extract_simulations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract simulations — extract_simulations","text":"Named list: Data: dataframe columns Patient, Time, Index, Score corresponding simulations Parameters: dataframe containing parameters used generate data (cf. HuraultMisc::extract_draws())","code":""},{"path":"/reference/extract_simulations.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract simulations — extract_simulations","text":"function designed use Markov Chain model (MC).","code":""},{"path":"/reference/forward_chaining.html","id":null,"dir":"Reference","previous_headings":"","what":"Forward chaining — forward_chaining","title":"Forward chaining — forward_chaining","text":"forward chaining setting, retrain/update model every horizon day/week/months/etc. test model next horizon day/week/months/etc., .e. data included next training step. call training/testing steps iterations start iteration 0 first timepoint included. iteration 1, timepoints 1 1 + horizon included.","code":""},{"path":"/reference/forward_chaining.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Forward chaining — forward_chaining","text":"","code":"get_fc_iteration(t, horizon)  split_fc_dataset(df, it)  detail_fc_training(df, horizon)  get_fc_training_iteration(it_test)"},{"path":"/reference/forward_chaining.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Forward chaining — forward_chaining","text":"t Vector timepoints horizon Updating horizon df Dataframe columns Patient, Time, Horizon, Iteration. columns Time required detail_fc_training. Iteration number it_test Vector testing iteration numbers","code":""},{"path":"/reference/forward_chaining.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Forward chaining — forward_chaining","text":"get_fc_iteration returns vector corresponding iteration numbers split_fc_dataset returns named list dataframes (Training Testing) get_fc_training_iteration returns vector unique training iteration number detail_fc_training returns dataframe columns: Iteration, N, Proportion, LastTime","code":""},{"path":"/reference/forward_chaining.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Forward chaining — forward_chaining","text":"get_fc_iteration associate vector timepoints t corresponding iteration. split_fc_dataset split dataset df training testing set, computes prediction horizon last available score test set. get_fc_training_iteration identify training iterations test set empty detail_fc_training derive training data characteristics iteration df, including number training observations, proportion training observations total number observations, maximum timepoint training sets. Time=t Iteration=means : Time=t new training data iteration Time=t training data iterations < Time=t testing data iteration -1 Time=t training data iterations >= ","code":""},{"path":"/reference/forward_chaining.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Forward chaining — forward_chaining","text":"","code":"h <- 2 df <- get_index2(t_max = rpois(10, 10)) df$Score <- rnorm(nrow(df)) df$Iteration <- get_fc_iteration(df$Time, h) sp <- split_fc_dataset(df, 1) train_it <- get_fc_training_iteration(df$Iteration) fc_char <- detail_fc_training(df, h)"},{"path":"/reference/generate_missing.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate missing values in a times-series — generate_missing","title":"Generate missing values in a times-series — generate_missing","text":"First last values missing. Missing indices can generated random (Binomial distribution) using Markov Chain (consecutive missing values deemed likely). markov chain parametrised terms steady state probability value missing probability next value observed current value also observed.","code":""},{"path":"/reference/generate_missing.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate missing values in a times-series — generate_missing","text":"","code":"generate_missing(   N,   type = c(\"random\", \"markovchain\"),   p_mis = 0.25,   p_obs_obs = 0.75 )"},{"path":"/reference/generate_missing.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate missing values in a times-series — generate_missing","text":"N Length time-series type Method generate missing values. One \"random\" \"markovchain\" p_mis Probability given value missing (steady state probability type = \"markovchain\") p_obs_obs Probability next value observed current observed (type = \"markovchain\")","code":""},{"path":"/reference/generate_missing.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate missing values in a times-series — generate_missing","text":"Logical vector length N","code":""},{"path":"/reference/generate_missing.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate missing values in a times-series — generate_missing","text":"","code":"generate_missing(10) #>  [1] FALSE FALSE  TRUE FALSE  TRUE FALSE FALSE  TRUE  TRUE FALSE generate_missing(10, type = \"markovchain\") #>  [1] FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE FALSE FALSE"},{"path":"/reference/get_compiled_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Get compiled model — get_compiled_model","title":"Get compiled model — get_compiled_model","text":"Get compiled model","code":""},{"path":"/reference/get_compiled_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get compiled model — get_compiled_model","text":"","code":"get_compiled_model(stanmodel)"},{"path":"/reference/get_compiled_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get compiled model — get_compiled_model","text":"stanmodel Stan model name. NB: may differ name model","code":""},{"path":"/reference/get_compiled_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get compiled model — get_compiled_model","text":"Compiled model (object pass rstan::sampling)","code":""},{"path":"/reference/get_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Associate (Patient, Time) pairs to corresponding index in the model — get_index","title":"Associate (Patient, Time) pairs to corresponding index in the model — get_index","text":"Associate (Patient, Time) pairs corresponding index model","code":""},{"path":"/reference/get_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Associate (Patient, Time) pairs to corresponding index in the model — get_index","text":"","code":"get_index(train, test = NULL)  get_index2(t_max)"},{"path":"/reference/get_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Associate (Patient, Time) pairs to corresponding index in the model — get_index","text":"train Training dataframe test Testing dataframe t_max Vector indicating length patient time-series","code":""},{"path":"/reference/get_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Associate (Patient, Time) pairs to corresponding index in the model — get_index","text":"Dataframe columns Patient, Time, Index","code":""},{"path":"/reference/get_index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Associate (Patient, Time) pairs to corresponding index in the model — get_index","text":"functions designed use Markov Chain model (MC).","code":""},{"path":"/reference/get_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Associate (Patient, Time) pairs to corresponding index in the model — get_index","text":"","code":"library(dplyr) id <- get_index2(t_max = rpois(10, 20)) df <- id %>% select(-Index) %>% slice_sample(prop = 0.9) %>% arrange(Patient, Time) get_index(train = df) #> # A tibble: 173 × 3 #>    Patient  Time Index #>      <int> <int> <int> #>  1       1     1     1 #>  2       1     2     2 #>  3       1     3     3 #>  4       1     4     4 #>  5       1     5     5 #>  6       1     6     6 #>  7       1     7     7 #>  8       1     8     8 #>  9       1     9     9 #> 10       1    10    10 #> # … with 163 more rows #> # ℹ Use `print(n = ...)` to see more rows"},{"path":"/reference/list_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"List available parameters — list_parameters","title":"List available parameters — list_parameters","text":"List available parameters","code":""},{"path":"/reference/list_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List available parameters — list_parameters","text":"","code":"list_parameters(model, ...)  # S3 method for BinRW list_parameters(model, main = TRUE, ...)  # S3 method for BinMC list_parameters(model, main = TRUE, ...)"},{"path":"/reference/list_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"List available parameters — list_parameters","text":"model Object, usually model name EczemaModel object ... Arguments pass methods main Whether output main parameters (applicable).","code":""},{"path":"/reference/list_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"List available parameters — list_parameters","text":"Named list parameters names, grouped broad categories: Population: population parameters (.e. patient- time-independent) Patient: patient-dependent parameters PatientTime: patient- time-dependent parameters (e.g. latent scores) Test: parameters related test set Misc: parameters","code":""},{"path":"/reference/list_parameters.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"List available parameters — list_parameters","text":"See MC, BinRW, BinMC, OrderedRW, RW, Smoothing, AR1 MixedAR1 details model-specific parameters. parameters available across models: y_rep correspond posterior replications. get corresponding index, use get_index(). y_pred subset y_rep corresponding test samples (size N_test equal number observations test set). lpd log predictive density test samples (size N_test). cum_err cumulative error distribution, available discrete outcomes (matrix dimensions N_test * (max_score  + 1)).","code":""},{"path":"/reference/list_parameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"List available parameters — list_parameters","text":"","code":"list_parameters(\"RW\") #> $Population #> [1] \"sigma\" #>  #> $PatientTime #> [1] \"y_rep\" #>  #> $Test #> [1] \"y_pred\" \"lpd\"    #>  #> $Misc #> [1] \"y_mis\" #>  list_parameters(EczemaModel(\"RW\", max_score = 100)) #> $Population #> [1] \"sigma\" #>  #> $PatientTime #> [1] \"y_rep\" #>  #> $Test #> [1] \"y_pred\" \"lpd\"    #>  #> $Misc #> [1] \"y_mis\" #>  list_parameters(EczemaModel(\"BinRW\", max_score = 100)) #> $Population #> [1] \"sigma\"          \"mu_logit_y0\"    \"sigma_logit_y0\" #>  #> $Patient #> [1] \"logit_y0\" #>  #> $PatientTime #> [1] \"y_lat\" \"y_rep\" #>  #> $Observation #> [1] \"log_lik\" #>  #> $Test #> [1] \"y_pred\"  \"lpd\"     \"cum_err\" #>  list_parameters(EczemaModel(\"BinMC\", max_score = 100)) #> $Population #> [1] \"mu_logit_p10\"    \"sigma_logit_p10\" \"sigma\"           #>  #> $Patient #> [1] \"p10\" #>  #> $PatientTime #> [1] \"p01\"    \"lambda\" \"ss1\"    \"y_lat\"  \"y_rep\"  #>  #> $Test #> [1] \"y_pred\"  \"lpd\"     \"cum_err\" #>"},{"path":"/reference/make_empty_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Create ","title":"Create ","text":"Used internally.","code":""},{"path":"/reference/make_empty_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create ","text":"","code":"make_empty_data(N_patient = 1, t_max = c(2), max_score, discrete)"},{"path":"/reference/make_empty_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create ","text":"N_patient Number patients datasets t_max Vector size N_patient indicating time-series length patient max_score Maximum value score can take discrete Whether use discrete normal distribution (relevant testing)","code":""},{"path":"/reference/make_empty_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create ","text":"List containing \"Training\" \"Testing\" dataframes","code":""},{"path":"/reference/make_empty_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create ","text":"","code":"make_empty_data(max_score = 10, discrete = TRUE) #> $Training #> # A tibble: 1 × 3 #>   Patient  Time Score #>     <int> <dbl> <dbl> #> 1       1     1     1 #>  #> $Testing #> # A tibble: 1 × 3 #>   Patient  Time Score #>     <int> <dbl> <dbl> #> 1       1     2     0 #>"},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/plot_latent_OrderedRW.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot the evolution of the expected latent score of the OrderedRW model — plot_latent_OrderedRW","title":"Plot the evolution of the expected latent score of the OrderedRW model — plot_latent_OrderedRW","text":"Plot evolution expected latent score OrderedRW model","code":""},{"path":"/reference/plot_latent_OrderedRW.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot the evolution of the expected latent score of the OrderedRW model — plot_latent_OrderedRW","text":"","code":"plot_latent_OrderedRW(fit, id, patient_id, ...)"},{"path":"/reference/plot_latent_OrderedRW.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot the evolution of the expected latent score of the OrderedRW model — plot_latent_OrderedRW","text":"fit Stanfit object id Dataframe linking index fit (Patient, Time) pairs, cf. output get_index() patient_id Patient ID ... Arguments pass add_fanchart()","code":""},{"path":"/reference/plot_latent_OrderedRW.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot the evolution of the expected latent score of the OrderedRW model — plot_latent_OrderedRW","text":"Ggplot Horizontal lines correspond expected cut-offs Ribbons correspond CI logistic distribution","code":""},{"path":"/reference/plot_ppc.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot posterior predictive trajectory — plot_ppc","title":"Plot posterior predictive trajectory — plot_ppc","text":"Plot probability mass function (suffix _pmf) fanchart (stacked confidence interval, suffix _fanchart). plot_post_traj_* plots posterior predictive trajectory plot_ppc_traj_* overlays observed trajectory posterior predictive trajectory","code":""},{"path":"/reference/plot_ppc.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot posterior predictive trajectory — plot_ppc","text":"","code":"plot_post_traj_pmf(   obj,   id,   patient_id,   max_score = NA,   support = NULL,   max_scale = NA )  plot_post_traj_fanchart(   obj,   id,   patient_id,   max_score = NA,   interval = c(\"eti\", \"hdi\"),   CI_level = seq(0.1, 0.9, 0.1),   ... )  plot_ppc_traj_pmf(obj, train, test, patient_id, max_score = NA, ...)  plot_ppc_traj_fanchart(obj, train, test, patient_id, max_score = NA, ...)"},{"path":"/reference/plot_ppc.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot posterior predictive trajectory — plot_ppc","text":"obj Stanfit object matrix replications, rows corresponding samples columns corresponding variables (nrow(id) columns). id Dataframe linking index obj (Patient, Time) pairs, cf. output get_index(). patient_id Patient ID. max_score (Optional) Maximum value score can take. plot_*_traj_pmf set support supplied. plot_*_traj_fanchart set y axis range. plot_ppc_traj_* check content train test. support Values discrete distribution can take. Can NULL, case support pmf estimated data (cf. HuraultMisc::extract_distribution()). max_scale Maximum value legend display. NA, chosen automatically. interval Type confidence interval display, one \"eti\" equal-tailed intervals \"hdi\" highest density interval. CI_level Vector confidence level plot fanchart. ... arguments pass plot_post_traj_*. plot_post_traj_fanchart(), arguments pass add_fanchart(). train Training dataset used obtain fit. test Testing dataset used obtain fit (can NULL).","code":""},{"path":"/reference/plot_ppc.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot posterior predictive trajectory — plot_ppc","text":"Ggplot","code":""},{"path":"/reference/plot_transition_MC.html","id":null,"dir":"Reference","previous_headings":"","what":"Markov Chain expected transition matrix — plot_transition_MC","title":"Markov Chain expected transition matrix — plot_transition_MC","text":"Markov Chain expected transition matrix","code":""},{"path":"/reference/plot_transition_MC.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Markov Chain expected transition matrix — plot_transition_MC","text":"","code":"plot_transition_MC(fit, max_scale = NA, show_text = FALSE)"},{"path":"/reference/plot_transition_MC.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Markov Chain expected transition matrix — plot_transition_MC","text":"fit Stanfit object corresponding Markov Chain model max_scale Maximum value legend display. NA, chosen automatically. show_text Whether display probability text heatmap.","code":""},{"path":"/reference/plot_transition_MC.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Markov Chain expected transition matrix — plot_transition_MC","text":"Ggplot","code":""},{"path":"/reference/prepare_standata.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare the data list to pass to the Stan sampler — prepare_standata","title":"Prepare the data list to pass to the Stan sampler — prepare_standata","text":"Used internally.","code":""},{"path":"/reference/prepare_standata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare the data list to pass to the Stan sampler — prepare_standata","text":"","code":"prepare_standata(model, train, test, ...)  prepare_data_lgtd(train, test = NULL, max_score, discrete)"},{"path":"/reference/prepare_standata.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare the data list to pass to the Stan sampler — prepare_standata","text":"model Object train Training dataframe (details format EczemaFit()) test Testing dataframe (details format EczemaFit()) ... Arguments pass methods max_score Maximum value score can take discrete Whether use discrete normal distribution (relevant testing)","code":""},{"path":"/reference/prepare_standata.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare the data list to pass to the Stan sampler — prepare_standata","text":"List serve input Stan sampler. list usually incomplete needs optional parameters, : run (binary, main MC models, indicating whether evaluate likelihood)","code":""},{"path":"/reference/prepare_standata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare the data list to pass to the Stan sampler — prepare_standata","text":"prepare_data_lgtd helps build prepare_standata.EczemaModel kept compatibility reasons. list outputs include priors.","code":""},{"path":"/reference/print.EczemaModel.html","id":null,"dir":"Reference","previous_headings":"","what":"Print model — print.EczemaModel","title":"Print model — print.EczemaModel","text":"Print model","code":""},{"path":"/reference/print.EczemaModel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print model — print.EczemaModel","text":"","code":"# S3 method for EczemaModel print(x, digits = 2, ...)"},{"path":"/reference/print.EczemaModel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print model — print.EczemaModel","text":"x Object class EczemaModel digits Number significant digits print ... Arguments pass print_prior()","code":""},{"path":"/reference/print.EczemaModel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print model — print.EczemaModel","text":"None","code":""},{"path":"/reference/print_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Print prior distribution — print_prior","title":"Print prior distribution — print_prior","text":"Used internally print.EczemaModel method.","code":""},{"path":"/reference/print_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print prior distribution — print_prior","text":"","code":"print_prior(model, ...)  print_distribution(parameter_name, distribution_name, arguments, digits = 2)"},{"path":"/reference/print_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print prior distribution — print_prior","text":"model Object ... Arguments pass methods parameter_name Name parameter distribution_name Name distribution arguments Arguments distribution (numeric vector) digits Number significant digits print (cf. base::signif())","code":""},{"path":"/reference/print_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print prior distribution — print_prior","text":"None","code":""},{"path":"/reference/print_prior.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Print prior distribution — print_prior","text":"print_prior usually calls print_distribution additional argument digits (except base method EczemaModel object).","code":""},{"path":"/reference/print_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print prior distribution — print_prior","text":"","code":"model <- EczemaModel(\"BinRW\", max_score = 10) print_prior(model) #> - sigma ~ normal+(0,0.4) #> - mu_logit_y0 ~ normal(0,1) #> - sigma_logit_y0 ~ normal(0,1.5) print_prior(model, digits = 5) #> - sigma ~ normal+(0,0.40236) #> - mu_logit_y0 ~ normal(0,1) #> - sigma_logit_y0 ~ normal(0,1.5) print_distribution(\"x\", \"normal\", c(0, 1)) #> - x ~ normal(0,1)"},{"path":"/reference/replace_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Replace prior — replace_prior","title":"Replace prior — replace_prior","text":"Used internally overwrite default prior constructor. Beware validity new prior tested function, may want call validate_prior() using function.","code":""},{"path":"/reference/replace_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Replace prior — replace_prior","text":"","code":"replace_prior(x, prior = NULL)"},{"path":"/reference/replace_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Replace prior — replace_prior","text":"x EczemaModel object prior Named list model's prior replace. NULL, prior stays ","code":""},{"path":"/reference/replace_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Replace prior — replace_prior","text":"Object class x","code":""},{"path":"/reference/replace_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Replace prior — replace_prior","text":"","code":"model <- EczemaModel(\"OrderedRW\", max_score = 5) print(model) #> OrderedRW model (discrete) #> max_score = 5  #> Prior:  #> - delta ~ dirichlet(2,2,2,2) #> - sigma_meas / max_score ~ lognormal(-2.3,0.69) #> - sigma_lat / max_score ~ lognormal(-2.3,0.69) #> - mu_y0 / max_score ~ normal(0.5,0.25) #> - sigma_y0 / max_score ~ normal+(0,0.12) replace_prior(model, prior = list(sigma = c(0, 1))) #> Warning: The following parameters do not exist or their priors do not need to be specified: sigma #> OrderedRW model (discrete) #> max_score = 5  #> Prior:  #> - delta ~ dirichlet(2,2,2,2) #> - sigma_meas / max_score ~ lognormal(-2.3,0.69) #> - sigma_lat / max_score ~ lognormal(-2.3,0.69) #> - mu_y0 / max_score ~ normal(0.5,0.25) #> - sigma_y0 / max_score ~ normal+(0,0.12)"},{"path":"/reference/sample_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Prior predictive distribution — sample_prior","title":"Prior predictive distribution — sample_prior","text":"Prior predictive distribution","code":""},{"path":"/reference/sample_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prior predictive distribution — sample_prior","text":"","code":"sample_prior(model, ...)  # S3 method for EczemaModel sample_prior(model, N_patient = 1, t_max = c(2), ...)  # S3 method for MC sample_prior(   model,   data = data.frame(y0 = integer(), y1 = integer(), dt = integer()),   ... )"},{"path":"/reference/sample_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prior predictive distribution — sample_prior","text":"model Object ... Arguments pass rstan::sampling() N_patient Number patients simulate t_max Vector size N_patient indicating time-series length patient data Dataframe (see details ). columns y0 dt relevant simulate data .","code":""},{"path":"/reference/sample_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prior predictive distribution — sample_prior","text":"Object class stanfit","code":""},{"path":"/reference/sample_prior.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prior predictive distribution — sample_prior","text":"","code":"if (FALSE) { model <- EczemaModel(\"BinRW\", max_score = 100) sample_prior(model) } if (FALSE) { model <- EczemaModel(\"MC\", K = 5) sample_prior(model) }"},{"path":"/reference/samples_to_list.html","id":null,"dir":"Reference","previous_headings":"","what":"Process samples to a list that can be included to a dataframe — samples_to_list","title":"Process samples to a list that can be included to a dataframe — samples_to_list","text":"Process samples list can included dataframe","code":""},{"path":"/reference/samples_to_list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process samples to a list that can be included to a dataframe — samples_to_list","text":"","code":"samples_to_list(object, par_name = \"y_pred\", n_samples = NULL)"},{"path":"/reference/samples_to_list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Process samples to a list that can be included to a dataframe — samples_to_list","text":"object Stanfit object containing variable par_name matrix rows representing samples, columns representing variables. par_name Name variable extract object stanfit object. Default \"y_pred\" (variable containing predictions). n_samples many samples return. Default (=NULL) samples.","code":""},{"path":"/reference/samples_to_list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Process samples to a list that can be included to a dataframe — samples_to_list","text":"List vector samples","code":""},{"path":"/reference/samples_to_list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Process samples to a list that can be included to a dataframe — samples_to_list","text":"","code":"samples_to_list(matrix(rnorm(1e3), nrow = 1e2)) #> [[1]] #>   [1] -1.07391224  0.72632282  0.74767794  1.19446552  2.16435753  0.72656146 #>   [7] -0.65843939  1.06392165  0.56861340  0.01567327 -0.69870945 -1.61001460 #>  [13]  1.37176453 -0.56644868  1.12176136 -1.98543298 -1.55298373  0.66192288 #>  [19] -0.51318550  1.99926439 -0.95442197  1.54320117 -0.67729055 -1.61908353 #>  [25]  0.63824090 -0.94965453 -0.56227281  1.40596884 -0.27225807  0.57904272 #>  [31] -0.31176197  0.01958789  0.43343780  1.02339073  0.83274125  0.71272400 #>  [37] -1.16291478  0.03078538 -0.43900058 -0.78292244 -0.63606466  1.32657509 #>  [43]  1.12055820 -0.47356500  0.63085602  0.33004904  2.39777276 -0.38877170 #>  [49]  1.49936047 -0.20228847 -0.97211238  1.02994921  0.66820849  1.45877818 #>  [55]  0.10845491  0.12094121 -0.28337588 -0.33615202  0.56392160  0.56346627 #>  [61]  0.64927877 -0.60085364  0.74339267 -0.79760362  0.61135726  0.47397756 #>  [67]  1.16223723  1.62764924 -1.18152256  0.12397404 -1.52252180 -1.73896649 #>  [73]  1.06493921  0.80153047  1.68693363 -0.74507596  0.47542852 -0.63075867 #>  [79] -0.58560203 -0.87002384  0.06874574  0.06270511 -1.83485168 -0.09313480 #>  [85]  0.39508151 -0.83218773  0.09602872 -0.53847223 -0.01864987  1.23642276 #>  [91]  0.65164824  0.12918809  0.16917948 -0.06363146 -1.93982500 -1.73708200 #>  [97] -0.18965761  0.07802207 -0.52794124 -0.59561911 #>  #> [[2]] #>   [1]  2.506987239 -1.647395007 -1.177922471 -1.222182385 -1.879650014 #>   [6]  1.523403001 -1.194218105 -0.954351855  1.118387491 -0.582734717 #>  [11]  0.694856411 -0.346850312  1.588429662 -0.428521064 -0.428642947 #>  [16]  1.304954026  0.404664736  0.771389516  0.629679242 -0.452346776 #>  [21] -2.153798318 -0.566007467  0.682099685  1.079579192 -0.377190931 #>  [26]  0.154953571 -0.836822545  1.409999834  0.165546349  1.718106176 #>  [31]  0.162822076  2.999104589  0.512360996 -0.586697965 -0.599755821 #>  [36]  0.021920406  1.190560981 -0.544090010 -0.075081708  0.269755752 #>  [41]  0.692768493 -1.163129325 -0.888713425 -0.993519864 -0.989850403 #>  [46] -1.460952079  0.330132269 -0.510533176 -0.536561640  0.318898664 #>  [51] -0.372149800 -0.936992050  1.842076821  1.372335338 -2.572490237 #>  [56] -0.981732241  0.137466561  1.955653759  0.788804295  0.063552739 #>  [61] -0.426500636  0.449623830 -1.266948913 -0.297072897  0.603137093 #>  [66] -0.755083077 -0.069021496 -0.063220458 -0.307269556 -1.590949362 #>  [71] -1.204069758  2.521365588  1.436886730 -0.854227130 -0.003649967 #>  [76]  1.656731902  0.367203237  0.671449026  0.740100362 -1.058944077 #>  [81] -1.270330487  1.329339826  1.286746428  1.545438343  0.172838358 #>  [86] -0.154494700 -0.105630727 -0.089512236 -0.922736030 -0.658713992 #>  [91] -0.469081769  0.390248887 -1.018834175  1.352895156  1.349076078 #>  [96] -0.019791577 -0.895928473 -1.033038373  0.089957079  0.036091068 #>  #> [[3]] #>   [1] -0.27333063 -0.27610447  0.18991337  0.69232761  0.43768752  0.07043479 #>   [7]  1.51828710  0.58025998  0.57542987  0.20753799  0.91337722  1.18906591 #>  [13] -1.48646441  2.06007149  1.05598007 -0.34840271 -1.09307938  0.26620845 #>  [19]  0.46773948  0.57543507  0.13561647 -1.63161558 -0.36105309 -1.17173598 #>  [25] -1.95068936  0.32423290  0.44049357 -1.74020148 -0.19989745 -0.56592972 #>  [31]  2.50131290  0.51318834 -0.88533814 -1.55074799  0.11501835  0.91339401 #>  [37]  0.81218844 -0.24113456  2.58215531 -1.05981037  0.27823667 -1.03409592 #>  [43] -1.02303434  0.81795413 -1.18243371  1.92115700  1.06144950 -0.77568864 #>  [49] -0.19520052 -0.09991337 -0.08640749  1.87256915 -1.28017893 -0.27510891 #>  [55] -0.60518549  0.22690006 -1.45862992 -0.36862325  1.25202007  0.09559597 #>  [61]  1.09640425  0.72921374 -0.43446720  0.39409827 -1.07957988 -0.11039700 #>  [67] -1.89029315 -0.29818666  1.40722008 -0.15629478 -0.34758989 -0.21654242 #>  [73] -0.91322151  0.86148808  1.16059398  0.47851827 -0.25330602 -1.69698706 #>  [79] -0.38398773  0.27004575 -0.32300583 -0.59545618 -1.78829947  0.73508886 #>  [85]  1.56578477  0.40152084 -0.42141925 -0.05312468  1.59539764 -0.36953180 #>  [91]  2.09824521  0.83943674  0.25865698 -0.55593380  0.44432728 -0.67238382 #>  [97]  1.13246107  1.03519947 -1.60999550 -0.74538402 #>  #> [[4]] #>   [1]  1.38117218  0.08480017  1.02495197  0.79998181  0.12694249 -0.20208260 #>   [7]  0.19504115 -1.12852873 -0.28229261 -1.32444163  0.38073380 -1.41433978 #>  [13] -0.37081917  0.44635146  2.34240634  3.14601903 -1.51466613  0.35127043 #>  [19]  0.81290784  0.24135639 -1.57915805 -0.09381920  0.49755338  1.60772737 #>  [25]  0.25748405  0.51370360 -0.46921101 -1.21419821 -0.24177060 -0.72374315 #>  [31]  0.81763965 -1.91226583 -0.65056177 -0.36704828  1.66540368  1.86259969 #>  [37] -0.81254295 -0.72288892  0.11938490  0.66022930 -2.15834125 -0.72735195 #>  [43] -0.30679676 -1.75491250 -1.50746963 -0.76797275  0.26927811  0.37005110 #>  [49]  0.03459042  0.45427214  0.54415282  1.10780400  0.83915275  0.75960184 #>  [55]  0.55386281 -0.17574712  0.28534555 -0.09611311  0.73787578  0.44504715 #>  [61]  0.24933902  0.64817137 -0.34996096 -0.11529444  0.07137286 -0.20143293 #>  [67]  0.20499469  0.77144922  0.69381645 -0.97289070 -0.09994862  0.92285625 #>  [73]  0.01597948 -0.03685962  0.91841862  1.53992121 -0.69633198 -0.77076071 #>  [79] -0.71735535 -0.28713298 -0.23850492  0.47382679 -1.02353573 -0.34594382 #>  [85] -1.04285546  0.24332697  0.59810555 -0.07118692 -0.18308858  0.04236427 #>  [91] -0.51250874 -1.12034113 -0.16022012 -1.00812359 -0.86498954  0.19904051 #>  [97] -1.53974192 -1.67255254 -0.75804122  0.65011652 #>  #> [[5]] #>   [1] -1.75966603  0.07882397 -1.10105163 -1.27909072  0.39073412 -0.88450735 #>   [7]  1.00431723 -0.30263874 -0.50826313  1.85929708  0.84699818  0.30994603 #>  [13] -0.34958027 -0.51451004  0.08675165 -0.76455763  3.36591997  1.68534308 #>  [19] -0.78634098  0.40504928 -0.75971846 -0.56523706  0.40542358  1.88047632 #>  [25]  2.17898004  0.86937071  0.52914556  0.13629995 -0.26140447  0.83938914 #>  [31] -0.10468352  0.59749570 -1.17194879  1.35113467  0.52922462  0.15640525 #>  [37]  0.53094965 -0.20346857 -1.02325728  1.16659849  0.14693246  0.16096852 #>  [43] -0.36226492 -0.57058770  1.76368378  0.01360511 -0.42002316 -0.70072892 #>  [49] -1.81284386 -0.59811799 -0.67904259  1.82873294 -0.34973123  0.30031843 #>  [55] -1.30434119 -0.49620393  0.81133927  0.69334036 -0.10587426  0.04562836 #>  [61]  1.51158223 -0.70615569 -0.61038609 -0.42065325 -1.40768900 -0.67794653 #>  [67] -0.75321776  0.95167141  0.79038908 -1.13005624  0.19055314 -0.41412401 #>  [73] -0.84282575 -0.91669488 -3.07007062  0.49923643  2.21107564  0.26782552 #>  [79]  0.91667954  1.20625486 -0.60592057 -0.17590427 -0.43581946 -2.38003089 #>  [85] -1.11205889  0.32381936  0.07037668  0.71927397  1.67841318  0.32820851 #>  [91] -0.79368466 -1.39225800 -0.62438613  0.01434880  1.26868223  0.75304364 #>  [97]  0.17392451  0.10659862  0.37685745 -0.12036793 #>  #> [[6]] #>   [1] -0.6541048451  0.3955800205  0.3617158978  0.5384894928  0.1164112977 #>   [6]  1.3643751153  0.3214319655  1.2842951723 -1.6594483397  0.5669599473 #>  [11]  0.4545154227 -2.2161811341 -0.3963183616 -0.0587097434 -1.9801769785 #>  [16] -0.1693452512 -0.1414526342  1.9466547827 -0.0470986978 -0.0158973933 #>  [21]  0.8757972837  1.9007289221 -0.5347377782  0.9447868482  0.8568677405 #>  [26]  1.4067495707  0.1626234737 -0.3675951386  1.4467281962  0.5173810416 #>  [31] -0.0731040205  1.0968591226 -0.2207495592 -0.3278973922 -0.6357938845 #>  [36] -0.0004533774 -1.1559842311 -0.1130253516  0.4874163368  0.4852402940 #>  [41] -0.7362533559 -0.6854619808  0.4626427301  0.8878179691 -0.8469149204 #>  [46] -0.3620600741 -0.2826892996  1.1278121981 -1.3263101936  0.9976071979 #>  [51]  0.1685144439 -0.4908947884  0.1334723737 -0.6858790153  0.5590303647 #>  [56] -1.9580992624  0.8230390539  0.7152416381 -0.1049600471 -1.1709293222 #>  [61] -0.7881311202 -0.9327265847  0.1033752496 -0.1318753356 -0.4543954267 #>  [66]  0.3563005109 -0.8182882425  0.0200729699 -0.0128313839  0.1829914889 #>  [71] -0.9122030321  0.2849892263 -3.0773678761 -0.7290004536 -0.6766247362 #>  [76] -0.5043606202  0.1623989761  0.9260112846 -0.4153914571  2.4220905353 #>  [81] -1.1602028146 -1.5150782655 -0.6422341703  0.1250580843  0.1435633531 #>  [86] -0.3171942575 -0.5564301474  0.6195650189  1.2670788478  1.9995548447 #>  [91]  0.3478174742 -0.7482812210  0.9270541840  0.5065587896 -1.0280324999 #>  [96] -0.1911524656  1.5535183388  0.8924878422  0.7724111665  1.1226768163 #>  #> [[7]] #>   [1]  0.46306696 -0.72621906  0.15726585 -2.04131904 -1.42173749  0.43762384 #>   [7]  0.29063317 -0.03877927  1.29883393 -0.66976593 -0.20159304  1.09879888 #>  [13] -0.59396060  0.66466656  0.60139529 -0.52586748 -0.77581797 -0.60984083 #>  [19] -0.59911324 -0.33059514  1.21228834  1.80374424 -0.15263121  0.09339159 #>  [25] -0.97493594  0.42406985 -0.47761491 -1.05151542 -1.15484134 -2.21723095 #>  [31] -0.96820756 -1.37074140  0.77050846  0.55294862 -1.90574301 -0.25992591 #>  [37] -0.02680732  1.64111137  1.55690595 -1.15220462 -0.07654427 -1.15096619 #>  [43] -2.51273455  0.48852547  0.15468978  0.15294453  1.39240545  0.11140400 #>  [49] -0.47968380 -0.10552448 -0.29867080 -1.03739254 -1.10088586  0.08439542 #>  [55]  0.29960431  0.33995851 -1.31199143  0.22024774  0.19740998  0.83457778 #>  [61]  0.10952215  1.14765464  1.07924170  0.82005022  0.03034144 -0.61773291 #>  [67] -1.02502373 -0.08256784  0.50311417 -1.87459168  0.13255422 -1.04742998 #>  [73]  0.23767202 -1.23263962 -1.54032820  0.13777740  0.49461683  0.60598061 #>  [79]  0.45919335  0.10480618 -0.56800327  0.24498556 -0.06324096 -0.84987748 #>  [85]  0.87971436 -0.87165745  0.10068379  0.45026544  2.67245066  1.52154755 #>  [91]  0.81057673 -0.35930161 -0.79117568  0.95054096  0.60119579  0.93258562 #>  [97] -0.05717022  1.22469134 -1.86295507  1.49782715 #>  #> [[8]] #>   [1]  0.4975698565  0.5334456751  0.0089164666  0.2462387598  0.3038403435 #>   [6]  0.5918999914  0.2162272265  0.3658653617  0.3280311217 -0.8823203887 #>  [11]  1.1202358311 -0.0960379203  0.6026261103  0.7323090146  0.7149697484 #>  [16]  0.9133219486  2.3628276020 -1.3486650649 -0.8067928312  0.8552450870 #>  [21]  1.3177161603  1.7201849198 -0.3249018182  1.2168591163 -0.9826852240 #>  [26] -0.5854324195 -0.3451931548  2.0316574769  1.0944218552  0.8561512362 #>  [31]  1.5350577562 -0.3631117216 -0.8858677819 -0.9514075716  0.1910337237 #>  [36] -1.2758892701 -0.0802450401 -0.6082524935  0.7781137092 -0.9567991876 #>  [41] -0.5272814110 -0.3895486107 -0.0585738849  0.3311986641  0.0871214673 #>  [46] -1.3228289973 -0.9929137925  0.2061843611  0.1904828296  2.6181403735 #>  [51] -0.0614589356  1.3801829543  1.9398433344  0.1823286907 -0.5377418548 #>  [56]  0.9787552170 -1.0648672228  0.4838030339  0.0041447855  1.0088828132 #>  [61] -0.3618222361  0.4503501498 -2.9704783676  0.0220646481 -1.2089369739 #>  [66]  0.9566145197 -0.0002211627  0.5542231960  0.0576845046  1.4089985870 #>  [71]  0.1773888172 -0.7629126842  0.9498912132  0.5184861622 -1.1239603117 #>  [76]  0.5996287022 -0.9148617602  0.2086806516  1.3323407213 -1.1329294379 #>  [81]  0.3299285596 -0.2309252185  0.0516148640 -0.3448431872 -0.4236668395 #>  [86] -0.3013603962 -1.9278410429 -1.2233527371  1.0063018539 -1.1944233809 #>  [91] -0.2834274059  2.9995385625  0.1838915141  0.6906847069  0.1906545228 #>  [96]  0.6973646238 -0.3104020996  0.5706042504 -0.0158074286  0.0669393887 #>  #> [[9]] #>   [1] -0.011393431  1.085964504  0.647786816 -0.697923607 -1.145966679 #>   [6] -1.096190505  0.849482176  0.591876243  1.696491224  1.079850435 #>  [11] -1.456196898 -0.544149580  0.215143547 -0.265649805  1.026950214 #>  [16] -0.536510252  0.108638923  0.181164538 -0.934009560  1.162802731 #>  [21]  0.182762602  1.374353898 -0.899930741  1.067887962  1.502434664 #>  [26] -1.025219167 -0.016903991 -0.162805592 -1.144795403  0.174430941 #>  [31]  0.836515461 -1.029743888 -0.481918564 -0.088370464 -0.001663947 #>  [36] -0.658961519  0.134125403 -1.288302734 -2.279853910 -1.038353578 #>  [41]  0.062771633  0.657545496  1.241477009 -1.357141658 -0.116807130 #>  [46] -0.773332611 -0.534075873  1.465531903 -0.496957313 -0.717285138 #>  [51] -1.431907373  0.234131278  1.218626997  0.246245727 -1.737313320 #>  [56] -0.798997412  0.270981160 -1.238282144  0.143075117 -1.196849026 #>  [61]  0.732773175 -0.998893319 -0.576948122 -0.437421287 -1.029728011 #>  [66]  0.132524720  0.114103371 -0.191216974 -0.808268305  0.318803076 #>  [71]  0.104728596 -0.601243571  0.101335090  0.507381779  0.242606772 #>  [76] -0.487963029  0.124559429  0.460319328 -1.010870695  1.667732620 #>  [81] -0.505955521  0.031858886 -0.393496794  0.654789266  0.415608131 #>  [86] -0.222601745  0.432614896 -0.861580410 -1.644709868  1.027923328 #>  [91] -1.599709075 -0.463796202 -1.624124003  1.578944434 -0.929852514 #>  [96]  0.936513654  0.625519845  0.178203728  0.379096574  0.279865066 #>  #> [[10]] #>   [1]  1.464699708  0.708408938 -1.208473636  0.913674986  0.358173162 #>   [6] -0.308519905  0.903039881  0.799871595 -0.120098335 -0.421495049 #>  [11]  1.204873112 -0.463028778 -0.283315332 -2.746608926 -1.013876285 #>  [16] -2.681693283 -1.775096279 -1.142192151 -1.057871407 -0.445886314 #>  [21]  1.166305351 -0.201691502 -0.272217266 -0.315499550  0.420722071 #>  [26] -1.695917141 -1.101697607  0.389035364 -0.790149576  0.148200695 #>  [31]  0.399947312 -0.966988930  2.297243593  0.551542941 -1.040081895 #>  [36]  0.080633101 -0.922457665  0.588676941 -0.751850307 -0.064899969 #>  [41]  1.761739940  0.919662520 -0.539578234 -1.651499895 -1.286774187 #>  [46]  0.454170963  0.709103364  1.853295831  1.413147495  1.496911039 #>  [51] -0.868241745 -0.695662781  0.711028182  2.832952348  0.173825802 #>  [56] -0.557890983 -0.185233786 -0.101896090  0.029275633  1.358675647 #>  [61]  0.093679404 -0.131178069 -0.242318097  0.596690432 -0.616032661 #>  [66]  0.104939461  0.772059381  0.005913627 -0.773001566 -0.482461149 #>  [71] -0.013914788 -0.969230489 -0.732023663 -0.052835127  1.579402994 #>  [76] -0.592288201  0.403231656 -1.510727540  1.331485688  0.434781148 #>  [81]  0.602543291  0.928377660  0.981365173 -1.395874929 -0.858162831 #>  [86] -0.460890870  1.363103647  0.663433936  0.981712101 -1.240611812 #>  [91]  0.151930039  0.028145867  0.620198095  0.413493736  0.399275140 #>  [96] -1.153075874 -0.628354038  0.925914552 -1.454884414 -1.457751344 #>"},{"path":"/reference/validate_prior.html","id":null,"dir":"Reference","previous_headings":"","what":"Check the prior of an EczemaModel is correct — validate_prior","title":"Check the prior of an EczemaModel is correct — validate_prior","text":"Used internally constructing EczemaModel.","code":""},{"path":"/reference/validate_prior.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check the prior of an EczemaModel is correct — validate_prior","text":"","code":"validate_prior(model, ...)"},{"path":"/reference/validate_prior.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check the prior of an EczemaModel is correct — validate_prior","text":"model Object ... Arguments pass methods","code":""},{"path":"/reference/validate_prior.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check the prior of an EczemaModel is correct — validate_prior","text":"NULL statements TRUE, otherwise error message","code":""},{"path":[]},{"path":"/news/index.html","id":"eczemapred-030","dir":"Changelog","previous_headings":"","what":"EczemaPred 0.3.0","title":"EczemaPred 0.3.0","text":"Add plotting helpers add_fanchart() add_broken_pointline() Allow discrete input MixedAR1 Refactor tests Minor bug fixes refactoring","code":""},{"path":"/news/index.html","id":"eczemapred-020","dir":"Changelog","previous_headings":"","what":"EczemaPred 0.2.0","title":"EczemaPred 0.2.0","text":"Reparametrise OrderedRW model","code":""},{"path":"/news/index.html","id":"eczemapred-011","dir":"Changelog","previous_headings":"","what":"EczemaPred 0.1.1","title":"EczemaPred 0.1.1","text":"Post publication release Update README, workflows Add citation file Combine RW, Smoothing AR1 single Stan model, thus reducing compilation time installation allowing discrete input Smoothing AR1 Minor bug fixes","code":""},{"path":"/news/index.html","id":"eczemapred-010","dir":"Changelog","previous_headings":"","what":"EczemaPred 0.1.0","title":"EczemaPred 0.1.0","text":"Initial release","code":""}]
